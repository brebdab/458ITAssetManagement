(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{210:function(e,t,a){},242:function(e,t,a){},243:function(e,t,a){},313:function(e,t,a){},366:function(e,t,a){e.exports=a(727)},460:function(e,t,a){},569:function(e,t,a){},570:function(e,t,a){},63:function(e,t,a){},709:function(e,t,a){},710:function(e,t,a){},711:function(e,t,a){},712:function(e,t,a){},713:function(e,t,a){},714:function(e,t,a){},726:function(e,t,a){},727:function(e,t,a){"use strict";a.r(t);a(23),a(152),a(367),a(368),a(153);var n=a(0),s=a.n(n),r=a(19),o=a.n(r);a(210),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i,l,c,u=a(208),d=a(314),p=a(6),m=a(7),h=a(9),f=a(8),g=a(10),E=a(13),v=a(16),b=a(49),k=a(61),_=a(1),S=a(88),w=a(26),O=a(5),y=a.n(O),N=window&&window.location&&window.location.hostname,C="".concat("rack-city-dev.herokuapp.com"===N?"https://rack-city-dev.herokuapp.com":"rack-city-staging.herokuapp.com"===N?"https://rack-city-staging.herokuapp.com":"rack-city-prod.herokuapp.com"===N?"https://rack-city-prod.herokuapp.com":"http://192.168.1.17:8000","/");!function(e){e.LOGIN="/login",e.RACKS="/dashboard/racks",e.DATACENTERS="/dashboard/datacenters",e.MODELS="/dashboard/models",e.ASSETS="/dashboard/assets",e.DASHBOARD="/dashboard",e.REPORT="/dashboard/report",e.LOGS="/dashboard/logs",e.RACK_PRINT="/dashboard/rack-print",e.BULK_IMPORT="/dashboard/bulk-upload/:resourceType",e.USERS="/dashboard/users",e.CHANGE_PLAN="/dashboard/change-plans",e.BARCODE_PRINT="/assets/barcode-print"}(i||(i={})),function(e){e.RACK="racks",e.ASSET="assets",e.MODEL="models",e.USER="users",e.DATACENTER="datacenters",e.CHANGEPLANS="change-plans"}(l||(l={})),function(e){e.LEFT="L",e.RIGHT="R"}(c||(c={}));var A,D={asset_number:"Asset Number",hostname:"Hostname",model:"Model",model__vendor:"Model Vendor",model__model_number:"Model Number",rack:"Rack",rack__datacenter__name:"Datacenter",rack_position:"Rack Position",owner:"Owner",comment:"Comment",decommissioning_user:"Decommissioning User",time_decommissioned:"Time Decommissioned"},P={decommissioning_user:"User",time_decommissioned:"Time"},T={vendor:"Vendor",model_number:"Model Number",height:"Height",display_color:"Display Color",num_network_ports:"No. Network Ports",network_ports:"Network Ports",num_power_ports:"No. Power Ports",cpu:"CPU",memory_gb:"Memory (GB)",storage:"Storage",comment:"Comment"};function R(e){return e===Object(e)}function j(e){return e&&e.model_number}function I(e){return e&&e.abbreviation}function x(e){return e&&e.rack_num}function F(e){return e&&e.model}function M(e){return e&&(e.letter_start||""===e.letter_start)}function L(e){return e&&e.username}function U(e){return e&&e.name&&!e.abbreviation}function G(e){return e&&e.change_plan}!function(e){e.asset_number="Asset Number",e.hostname="Hostname",e.datacenter="Datacenter*",e.rack="Rack*",e.rack_position="Rack Position*",e.model="Model*",e.owner="Owner",e.comment="Comment",e.network_ports="Network Ports",e.power_connections="Power Connections"}(A||(A={}));var B=function(e){return{headers:{Authorization:"Token "+e}}},H=function(e){return{fontWeight:V(e)?"bold":"normal",color:V(e)?"#bf8c0a":"white"}};function V(e){return e&&e.change_plan}var K,z="https://oauth.oit.duke.edu/oauth/authorize.php?client_id=hyposoft-rack-city&response_type=token&state=1129&scope=basic&redirect_uri=",W=function(e){return{type:"SWITCH CHANGE PLAN",changePlan:e}},q=function(e){return Y.log("setting update changee plans to",e),{type:"UPDATE CHANGE PLANS",updateChangePlansBoolean:e}},Y={log:function(){}},J=function(e){return{type:"AUTH_SUCCESS",token:e}},Z=function(e){return{type:"AUTH_FAIL",error:e}},X=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),{type:"AUTH_LOGOUT"}},$=function(e){return function(t){var a={headers:{Authorization:"Token "+e}};y.a.get(C+"api/iamadmin",a).then((function(e){e.data.is_admin&&t({type:"AUTH_ADMIN"})})).catch((function(e){Y.log(e)}))}},Q=function(e){return function(t){var a={headers:{Authorization:"Token "+e}};y.a.get(C+"api/users/permissions/mine",a).then((function(e){var a={model_management:e.data.model_management,asset_management:e.data.asset_management,power_control:e.data.power_control,audit_read:e.data.audit_read,admin:e.data.admin,datacenter_permissions:e.data.datacenter_permissions};t(function(e){return{type:"SET PERMISSION STATE",permissionState:e}}(a))})).catch((function(e){Y.log(e)}))}},ee=function(e,t){var a=e.data.key,n=new Date((new Date).getTime()+36e5);localStorage.setItem("token",a),localStorage.setItem("expirationDate",n.toString()),t(J(a)),t($(a)),t(Q(a))},te=a(731),ae=a(732);function ne(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function se(e){return!!new RegExp("^([0-9A-Fa-f]{2}[-_:.,;]){5}([0-9A-Fa-f]{2})$|^[A-Fa-f0-9]{12}$").exec(e)}!function(e){e.CREATE="create",e.MODIFY="modify",e.DELETE="delete"}(K||(K={}));var re=s.a.createElement("p",null,"6-byte hexadecimal string with optional delimiters"),oe=function(e,t,a,n){var s;s=D[t]?D[t].toLowerCase():t.toLowerCase();var r=e.toLowerCase();return n?s===r:s.indexOf(r)>=0},ie=function(e,t,a,n){var s;s=T[t]?T[t].toLowerCase():t.toLowerCase();var r=e.toLowerCase();return n?s===r:s.indexOf(r)>=0},le=function(e,t,a,n){var s=t.toLowerCase(),r=e.toLowerCase();return n?s===r:s.indexOf(r)>=0},ce=function(e,t,a,n){var s=t.row_letter.toLowerCase(),r=t.rack_num,o=e.toLowerCase();return n?r===o||s===o:(s+r).indexOf(o)>=0},ue=function(e,t,a,n){var s=t.name.toLowerCase(),r=t.abbreviation.toLowerCase(),o=e.toLowerCase();return n?s===o||r===o:(r+s).indexOf(o)>=0},de=function(e,t,a,n){var s=t.name.toLowerCase(),r=e.toLowerCase();return n?s===r:s.indexOf(r)>=0},pe=function(e,t,a,n){var s=t.vendor.toLowerCase(),r=t.model_number.toLowerCase(),o=e.toLowerCase();return n?s===o||r===o:". ".concat(s," ").concat(r).indexOf(o)>=0},me=function(e,t,a,n){if(t.hostname){var s=t.hostname.toLowerCase(),r=e.toLowerCase();return n?s===r:". ".concat(s).indexOf(r)>=0}return!1};function he(e,t){var a=0,n=t.split(/\s+/).filter((function(e){return e.length>0})).map(ne);if(0===n.length)return[e];for(var r=new RegExp(n.join("|"),"gi"),o=[];;){var i=r.exec(e);if(!i)break;var l=i[0].length,c=e.slice(a,r.lastIndex-l);c.length>0&&o.push(c),a=r.lastIndex,o.push(s.a.createElement("strong",{key:a},i[0]))}var u=e.slice(a);return u.length>0&&o.push(u),o}var fe,ge=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=D[e];return s.a.createElement(S.p,{active:n.active,text:he(o,r),onClick:a})},Ee=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=T[e];return s.a.createElement(S.p,{active:n.active,text:he(o,r),onClick:a})},ve=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;return n.matchesPredicate?s.a.createElement(S.p,{active:n.active,text:he(e,r),onClick:a}):null},be=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=e.row_letter+e.rack_num;return s.a.createElement(S.p,{active:n.active,text:he(o,r),onClick:a})},ke=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=e.name;return s.a.createElement(S.p,{active:n.active,label:e.abbreviation,text:he(o,r),onClick:a})},_e=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=e.vendor;return s.a.createElement(S.p,{active:n.active,label:e.model_number,text:he(o,r),onClick:a})},Se=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=e.name;return s.a.createElement(S.p,{active:n.active,text:he(o,r),onClick:a})},we=function(e,t){var a=t.handleClick,n=t.modifiers,r=t.query;if(!n.matchesPredicate)return null;var o=e.hostname;return o?s.a.createElement(S.p,{active:n.active,label:e.model.vendor+" "+e.model.model_number,text:he(o,r),onClick:a}):null},Oe=te.a.ofType(),ye=ae.a.ofType(),Ne=te.a.ofType(),Ce=te.a.ofType(),Ae=te.a.ofType(),De=te.a.ofType(),Pe=te.a.ofType(),Te=a(30),Re=function(e,t){return Object(Te.a)({},e,{},t)},je=a(44),Ie=a(24),xe=a(150),Fe=function(e,t,a){var n=Array.from(e),s=n.splice(t,1),r=Object(je.a)(s,1)[0];return n.splice(a,0,r),n};!function(e){e.FILTER="filter",e.SORT="sort"}(fe||(fe={}));var Me,Le,Ue,Ge,Be=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).onDragEnd=function(e){if(e.destination){var t=Fe(a.props.items,e.source.index,e.destination.index);a.setState({items:t}),a.props.onChange&&a.props.onChange(t)}},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getEmptyListMessage",value:function(){return this.props.type===fe.FILTER?s.a.createElement(S.e,null,"Select filter(s) above"):this.props.type===fe.SORT?s.a.createElement(S.e,null,"Select column(s) to sort by below"):void 0}},{key:"getIcon",value:function(){return this.props.type===fe.FILTER?s.a.createElement(S.e,{className:"callout-icon",icon:Ie.a.FILTER}):this.props.type===fe.SORT?s.a.createElement(S.e,{className:"callout-icon",icon:Ie.a.DOUBLE_CARET_VERTICAL}):void 0}},{key:"render",value:function(){var e=this;return s.a.createElement(xe.a,{onDragEnd:this.onDragEnd},s.a.createElement(xe.c,{droppableId:"droppable",direction:"horizontal"},(function(t,a){return s.a.createElement("div",Object.assign({ref:t.innerRef,style:(a.isDraggingOver,{background:"#202B33",display:"flex",borderRadius:5,padding:2,minHeight:40,width:"100%",overflow:"auto",margin:5})},t.droppableProps),e.getIcon(),e.props.items.length>0?e.props.items.map((function(t,a){return s.a.createElement(xe.b,{key:t.id,draggableId:t.id,index:a},(function(a,n){return s.a.createElement("div",Object.assign({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(r=n.isDragging,o=a.draggableProps.style,Object(Te.a)({userSelect:"none",padding:8,margin:"0 ".concat(4,"px 0 0"),borderRadius:3,background:r?"#202B33":"#30404D"},o))}),e.props.renderItem(t));var r,o}))})):e.getEmptyListMessage(),t.placeholder)})))}}]),t}(s.a.Component);!function(e){e.NONE="none",e.DELETE="delete",e.DECOMMISSION="decommission",e.GRANT_ADMIN="grant_admin",e.REVOKE_ADMIN="revoke_admin"}(Me||(Me={})),function(e){e.TEXT="text",e.NUMERIC="numeric",e.RACKRANGE="rack_range",e.DATETIME="datetime"}(Le||(Le={})),function(e){e[e.TEN=10]="TEN",e[e.FIFTY=50]="FIFTY",e[e.HUNDRED=100]="HUNDRED",e.ALL="View All"}(Ue||(Ue={})),function(e){e.EXACT="exact",e.CONTAINS="contains"}(Ge||(Ge={}));var He=["rack_position","height","num_ethernet_ports","num_power_ports","memory_gb","num_network_ports"];function Ve(e){if(e)return"rack"===e?Le.RACKRANGE:"time_decommissioned"===e?Le.DATETIME:He.includes(e)?Le.NUMERIC:Le.TEXT}var Ke=function(e){return"".concat(e.match_type," ").concat(e.value)},ze=function(e){return"between ".concat(e.min," - ").concat(e.max)},We=function(e){return e.letter_end&&e.num_end?"rows  ".concat(e.letter_start," - ").concat(e.letter_end," & letters ").concat(e.num_start," - ").concat(e.num_end):e.letter_end?"rows  ".concat(e.letter_start," - ").concat(e.letter_end," & letters ").concat(e.num_start):e.num_end?"row  ".concat(e.letter_start,"  & letters ").concat(e.num_start," - ").concat(e.num_end):" ".concat(e.letter_start).concat(e.num_start," ")},qe=function(e){var t=e.after?new Date(e.after):void 0,a=e.before?new Date(e.before):void 0;return t&&a?"from ".concat(t.toLocaleString()," to ").concat(a.toLocaleString()):t?"after ".concat(t.toLocaleString()):a?"before ".concat(a.toLocaleString()):void 0},Ye=function(e,t){return y.a.post(C+"api/models/modify",e,t)},Je=function(e,t){var a={id:e.id};return y.a.post(C+"api/models/delete",a,t)},Ze=function(e,t){var a={id:e.id};return y.a.post(C+"api/assets/delete",a,t)},Xe=function(e,t,a){var n;return n=a?{headers:t.headers,params:{change_plan:a.id}}:t,y.a.post(C+"api/assets/modify",e,n)},$e=function(e,t,a){var n;n=a?{headers:t.headers,params:{change_plan:a.id}}:t;var s={id:e.id};return y.a.post(C+"api/assets/decommission",s,n)},Qe=function(e,t){return y.a.post(C+"api/change-plans/modify",e,t)},et=function(e,t){return y.a.post(C+"api/change-plans/delete",e,t)},tt=function(e,t){var a={id:e.id};return y.a.post(C+"api/datacenters/delete",a,t)},at=function(e,t){return y.a.post(C+"api/datacenters/modify",e,t)},nt=function(e,t){var a={id:e.id};return y.a.post(C+"api/users/delete",a,t)},st=function(e,t){return y.a.post(C+"api/users/permissions/set",e,t)},rt=(a(63),a(735)),ot=a(146),it=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return n.createElement(S.n,{type:this.props.type,className:this.props.className,placeholder:this.props.placeholder,value:this.props.value,onChange:function(t){return e.props.onChange(Object(ot.a)({},e.props.field,t.currentTarget.value))}})}}]),t}(n.Component),lt=(a(74),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={values:{}},a.componentDidMount=function(){a.setState({values:JSON.parse(JSON.stringify(a.props.values))})},a.componentWillReceiveProps=function(e){JSON.stringify(e.values)!==JSON.stringify(a.props.values)&&a.setState({values:JSON.parse(JSON.stringify(e.values))})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:this.props.className+" rack-range"},n.createElement("div",{className:"rack-letter"},n.createElement(S.k,{className:this.props.className,inline:!0,label:"Row Letter Range   "},n.createElement(it,{field:"letter_start",placeholder:"start",type:"text",value:this.state.values.letter_start,onChange:this.props.handleChange})),n.createElement("p",{className:"dash"},"to"),n.createElement(S.k,{className:this.props.className},n.createElement(it,{field:"letter_end",type:"text",placeholder:"end",value:this.props.values.letter_end,onChange:this.props.handleChange}))),n.createElement("div",{className:"rack-letter"},n.createElement(S.k,{className:this.props.className,inline:!0,label:"Rack Number Range"},n.createElement(it,{field:"num_start",type:"text",placeholder:"start",value:this.props.values.num_start,onChange:this.props.handleChange})),n.createElement("p",{className:"dash"},"to"),n.createElement(S.k,{className:this.props.className},n.createElement(it,{field:"num_end",type:"text",placeholder:"end",value:this.props.values.num_end,onChange:this.props.handleChange}))))}}]),t}(n.Component)),ct=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={id:"",field:"",filter:{},filter_type:Le.TEXT},a.handleChange=function(e){var t=Re(a.state.filter,Object(Te.a)({},e));console.log(Re(a.state.filter,Object(Te.a)({},e))),a.setState({filter:t})},a.handleDatetimeChange=function(e){console.log("handling datetime change");var t={after:e[0]?e[0].toISOString():void 0,before:e[1]?e[1].toISOString():void 0};a.setState({filter:t}),console.log("datetime filter: "),console.log(a.state.filter)},a.handleSubmit=function(e){e.preventDefault(),console.log("test");var t={field:a.state.field,filter_type:a.state.filter_type,filter:a.state.filter,id:a.state.field+JSON.stringify(a.state.filter)};console.log(t),a.props.handleAddFilter(t)},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"renderFilterOptions",value:function(e){var t=Ve(e);return t===Le.TEXT?this.getTextFilterOptions():t===Le.NUMERIC?this.getNumericFilterOptions():t===Le.RACKRANGE?this.getRackFilterOptions():t===Le.DATETIME?this.getDatetimeFilterOptions():null}},{key:"setTextFilterType",value:function(e){this.setState({})}},{key:"getRackFilterOptions",value:function(){return console.log(this.state.filter),this.state.filter&&M(this.state.filter)?n.createElement("div",null,n.createElement(lt,{className:"",values:this.state.filter,handleChange:this.handleChange})):null}},{key:"getDatetimeFilterOptions",value:function(){return n.createElement(S.k,{label:"Date range"},n.createElement(rt.a,{formatDate:function(e){return e.toLocaleString()},onChange:this.handleDatetimeChange,parseDate:function(e){return new Date(e)},allowSingleDayRange:!0,shortcuts:!0,singleMonthOnly:!0,closeOnSelection:!1,timePrecision:"minute",timePickerProps:{useAmPm:!0}}))}},{key:"getNumericFilterOptions",value:function(){return n.createElement("div",{className:"range"},n.createElement(S.k,{label:"Min"},n.createElement(it,{field:"min",placeholder:"min",onChange:this.handleChange})),n.createElement(S.k,{label:"Max"},n.createElement(it,{field:"max",placeholder:"max",onChange:this.handleChange})))}},{key:"getTextFilterOptions",value:function(){var e=this;return n.createElement("div",null,n.createElement("div",{className:"bp3-select field test-select"},n.createElement(S.l,{onChange:function(t){return e.handleChange({match_type:t.target.value})}}," ",n.createElement("option",null," ",Ge.CONTAINS),n.createElement("option",null,Ge.EXACT))),n.createElement(S.k,{label:"Query"},n.createElement(it,{field:"value",placeholder:"query",type:"string",onChange:this.handleChange})))}},{key:"setFilterType",value:function(e){this.setState({field:e,filter_type:Ve(e)});var t=Ve(e);if(t===Le.TEXT){var a={match_type:Ge.CONTAINS};console.log(Re(this.state.filter,Object(Te.a)({},a))),this.setState({filter:a})}if(t===Le.NUMERIC){this.setState({filter:{}})}if(t===Le.RACKRANGE){this.setState({filter:{letter_start:""}})}if(t===Le.DATETIME){console.log("set type to datetime");this.setState({filter:{}})}}},{key:"getItemRenderer",value:function(){return this.props.fields.includes("asset_number")?ge:this.props.fields.includes("vendor")?Ee:ve}},{key:"getItemFilterer",value:function(){return this.props.fields.includes("asset_number")?oe:this.props.fields.includes("vendor")?ie:le}},{key:"getButtonText",value:function(e){return D[e]?D[e]:T[e]?T[e]:e}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"test-fields"},n.createElement("form",{onSubmit:this.handleSubmit},n.createElement(S.k,{className:"field-select",label:"Select Field To Filter "}," ",n.createElement(ut,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},itemRenderer:this.getItemRenderer(),items:this.props.fields,onItemSelect:function(t){return e.setFilterType(t)},itemPredicate:this.getItemFilterer(),noResults:n.createElement(S.p,{disabled:!0,text:"No matching fields"})},n.createElement(S.c,{rightIcon:"caret-down",text:this.state.field?this.getButtonText(this.state.field):"Select a Field"}))),this.state.field?[this.renderFilterOptions(this.state.field),n.createElement("div",{className:"add-filter"},n.createElement(S.c,{icon:"filter",type:"submit"},"Add Filter"))]:null))}}]),t}(n.Component),ut=te.a.ofType(),dt=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin}}))(Object(v.f)(ct)),pt=(a(242),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).toaster={},a.addToast=function(e){e.timeout=5e3,a.toaster&&a.toaster.show(e)},a.addSuccessToast=function(e){a.addToast({message:e,intent:k.a.PRIMARY})},a.addErrorToast=function(e){a.addToast({message:e,intent:k.a.DANGER})},a.refHandlers={toaster:function(e){return a.toaster=e}},a.state={powerConnections:void 0,powerStatus:void 0,statusLoaded:!0,alertOpen:!1,confirmationMessage:""},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.assetIsDecommissioned||this.props.changePlan?this.setState({statusLoaded:!0}):(this.setState({statusLoaded:!0}),y.a.get(C+"api/power/get-state/"+this.props.asset.id,B(this.props.token)).then((function(t){e.setState({powerConnections:t.data.power_connections,powerStatus:t.data.power_status,statusLoaded:!0})})).catch((function(t){e.addErrorToast(t.response.data.failure_message),e.setState({statusLoaded:!0})}))),this.getUsername(this.props.token)}},{key:"componentDidUpdate",value:function(){var e=this;this.props.shouldUpdate?this.props.assetIsDecommissioned||this.props.changePlan||(y.a.get(C+"api/power/get-state/"+this.props.asset.id,B(this.props.token)).then((function(t){e.setState({powerConnections:t.data.power_connections,powerStatus:t.data.power_status,statusLoaded:!0})})).catch((function(t){e.addErrorToast(t.response.data.failure_message),e.setState({statusLoaded:!0})})),this.setState({statusLoaded:!0})):this.setState({statusLoaded:!0}),this.props.updated()}},{key:"getUsername",value:function(e){var t=this,a={headers:{Authorization:"Token "+e}};y.a.get(C+"api/users/who-am-i",a).then((function(e){t.setState({username:e.data.username})})).catch((function(e){}))}},{key:"getPowerPortRows",value:function(){var e=[];if(this.props.asset)for(var t=1;t<this.props.asset.model.num_power_ports+1;t++)e.push(n.createElement("tr",null,n.createElement("td",{style:H(this.props.asset)},t),this.props.asset.power_connections[t]?n.createElement("td",{style:H(this.props.asset)},this.props.asset.power_connections[t].port_number,this.props.asset.power_connections[t].left_right):n.createElement("td",null),this.props.asset.rack.is_network_controlled?this.state.powerStatus?n.createElement("td",null,this.state.powerStatus[t]):this.props.assetIsDecommissioned||this.props.changePlan?n.createElement("td",null," "):n.createElement("td",null,"Unable to contact PDU controller"):n.createElement("td",null,"PDU not network controlled")));return e}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:_.a.DARK},this.state.statusLoaded?this.props.asset&&this.props.asset.model.num_power_ports>0?n.createElement("div",{className:"propsview"},n.createElement("h3",null,"Power Connections"),n.createElement("div",{className:"network-connections"},n.createElement("table",{className:"bp3-html-table bp3-html-table-bordered bp3-html-table-striped"},n.createElement("tr",null,n.createElement("th",null,"Power Port Number"),n.createElement("th",null,"PDU Port Number"),n.createElement("th",null,"Power Status")),n.createElement("tbody",null,this.getPowerPortRows()))),this.props.asset.rack.is_network_controlled&&Object.keys(this.props.asset.power_connections).length>0&&this.state.powerStatus&&!this.props.assetIsDecommissioned&&!this.props.changePlan?n.createElement(S.b,{className:"power-close",intent:"OFF"===this.state.powerStatus[Object.keys(this.state.powerStatus)[0]]?"primary":"danger",minimal:!0,text:"OFF"===this.state.powerStatus[Object.keys(this.state.powerStatus)[0]]?"Turn on":"Turn off",icon:"power",disabled:!(this.props.permissionState.admin||this.props.permissionState.power_control||this.state.username===this.props.asset.owner),onClick:"OFF"===this.state.powerStatus[Object.keys(this.state.powerStatus)[0]]?function(){e.setState({statusLoaded:!e.state.statusLoaded}),y.a.post(C+"api/power/mask-on",{id:e.props.asset.id},B(e.props.token)).then((function(t){e.setState({alertOpen:!0,confirmationMessage:t.data.success_message}),e.componentDidMount()})).catch((function(e){alert(e)}))}:function(){e.setState({statusLoaded:!e.state.statusLoaded}),y.a.post(C+"api/power/mask-off",{id:e.props.asset.id},B(e.props.token)).then((function(t){e.setState({alertOpen:!0,confirmationMessage:t.data.success_message}),e.componentDidMount()})).catch((function(e){alert(e)}))}}):null,this.props.asset.rack.is_network_controlled&&Object.keys(this.props.asset.power_connections).length>0&&this.state.powerStatus&&!this.props.assetIsDecommissioned&&!this.props.changePlan?n.createElement(S.b,{className:"power-close",minimal:!0,intent:"warning",text:"Cycle Power",disabled:!(this.props.permissionState.admin||this.props.permissionState.power_control||this.state.username===this.props.asset.owner),onClick:function(){e.setState({statusLoaded:!e.state.statusLoaded}),y.a.post(C+"api/power/cycle",{id:e.props.asset.id},B(e.props.token)).then((function(t){e.setState({alertOpen:!0,confirmationMessage:t.data.success_message}),e.componentDidMount()})).catch((function(e){alert(e)}))}}):null,void 0===this.props.callback?null:n.createElement(S.b,{className:"power-close",intent:"danger",minimal:!0,text:"Close",onClick:function(){e.setState({powerConnections:void 0,powerStatus:void 0,statusLoaded:!1}),e.props.callback()}})):n.createElement("div",{className:"propsview"},n.createElement("h3",null,"Power Connections"),n.createElement(S.e,{title:"No power ports",icon:Ie.a.INFO_SIGN}),void 0===this.props.callback?null:n.createElement(S.b,{className:"power-close",intent:"danger",minimal:!0,text:"Close",onClick:function(){e.setState({powerConnections:void 0,powerStatus:void 0,statusLoaded:!1}),e.props.callback()}})):n.createElement(S.z,null),n.createElement(S.a,{className:_.a.DARK,confirmButtonText:"Okay",isOpen:this.state.alertOpen,onConfirm:function(){e.setState({alertOpen:!1})},onClose:function(){e.setState({alertOpen:!1})}},n.createElement("p",null,this.state.confirmationMessage)),n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}))}}]),t}(n.PureComponent)),mt=Object(v.f)(Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,changePlan:e.changePlan,permissionState:e.permissionState}}))(pt)),ht=a(22),ft=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={page_type:10,filters:[],sort_by:[],items:[],sorted_cols:[],curr_page:1,total_pages:0,fields:[],isEditFormOpen:!1,editFormValues:{},openAlert:Me.NONE,selected_userid:void 0,isPowerOptionsOpen:!1,getDataInProgress:!1,selected:[],selectedAll:!1,editUserFormOpen:!1},a.validRequestMadeWithToken=!1,a.resetPage=function(){a.setState({curr_page:1})},a.previousPage=function(){if(a.state.curr_page>1&&a.props.getData){var e=a.state.curr_page-1;a.setState({curr_page:e}),a.updatePageData(a.state.page_type,e)}},a.nextPage=function(){if(a.state.curr_page<a.state.total_pages&&a.props.getData){var e=a.state.curr_page+1;a.setState({curr_page:e}),a.updatePageData(a.state.page_type,e)}},a.handlePagingChange=function(e){a.setState({page_type:e,curr_page:1}),a.updatePageData(e,1)},a.getScrollIcon=function(e){return a.props.disableSorting?null:s.a.createElement(S.m,{className:"icon",icon:Ie.a.DOUBLE_CARET_VERTICAL,iconSize:S.m.SIZE_STANDARD,onClick:function(){return a.handleSort(e)}})},a.renderFilterItem=function(e){var t;e.filter_type===Le.TEXT?t=Ke(e.filter):e.filter_type===Le.NUMERIC?t=ze(e.filter):e.filter_type===Le.RACKRANGE?t=We(e.filter):e.filter_type===Le.DATETIME&&(t=qe(e.filter));var n=e.field;return a.props.type===l.ASSET?n=D[e.field]:a.props.type===l.MODEL&&(n=T[e.field]),s.a.createElement("div",{className:"drag-drop-text"},s.a.createElement("span",null,"".concat(n," ").concat(t,"\n      ")),s.a.createElement("span",null,s.a.createElement(S.m,{className:"icon",icon:Ie.a.DELETE,iconSize:S.m.SIZE_STANDARD,onClick:function(){return a.removeFilterItem(e)}})))},a.renderSortItem=function(e){return s.a.createElement("div",{className:"drag-drop-text "},s.a.createElement("span",null,s.a.createElement(S.m,{className:"icon",icon:Ie.a.DRAG_HANDLE_VERTICAL,iconSize:S.m.SIZE_STANDARD})),s.a.createElement("span",null,"".concat(e.field," by ").concat(e.ascending?"ascending":"descending")),s.a.createElement("span",null,s.a.createElement(S.m,{className:"icon",icon:Ie.a.DELETE,iconSize:S.m.SIZE_STANDARD,onClick:function(){return a.removeSortItem(e.field)}})))},a.updateSortOrder=function(e){a.setState({sort_by:e}),a.updateSortData(e)},a.removeSortItem=function(e){var t=a.state.sort_by,n=a.state.sorted_cols,s=n.indexOf(e,0);s>-1&&n.splice(s,1),t=t.filter((function(t){return t.field!==e})),a.setState({sort_by:t,sorted_cols:n}),a.updateSortData(t)},a.removeFilterItem=function(e){var t=a.state.filters.filter((function(t){return JSON.stringify(t)!==JSON.stringify(e)}));a.setState({filters:t}),a.updateFilterData(t)},a.addFilter=function(e){var t=a.state.filters.slice();if(M(e.filter)&&a.props.currDatacenter&&""!==a.props.currDatacenter.id){var n=Re(e.filter,{datacenter:a.props.currDatacenter.id});e=Re(e,{filter:n})}t.push(e);var s=a.updateFilterData(t);s&&s.then((function(e){a.setState({filters:t})})).catch((function(e){}))},a.updateFilterData=function(e){var t;return void 0!==a.props.callback&&a.props.callback(e),a.resetPage(),a.props.getPages&&a.props.getPages(a.props.type,a.state.page_type,e,a.props.token).then((function(e){a.setState({total_pages:e})})),a.props.getData&&(a.setState({getDataInProgress:!0}),(t=a.props.getData(a.props.type,1,a.state.page_type,{sort_by:a.state.sort_by,filters:e},a.props.token)).then((function(e){a.setState({getDataInProgress:!1}),a.setState({items:e}),0===e.length&&a.setState({curr_page:0})})).catch((function(e){a.setState({getDataInProgress:!1}),a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))),t},a.updatePageData=function(e,t){a.props.getData&&(a.setState({getDataInProgress:!0}),a.props.getData(a.props.type,t,e,{sort_by:a.state.sort_by,filters:a.state.filters},a.props.token).then((function(e){a.setState({items:e,getDataInProgress:!1})})).catch((function(e){a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER}),a.setState({getDataInProgress:!1})}))),a.props.getPages&&a.props.getPages(a.props.type,e,a.state.filters,a.props.token).then((function(e){a.setState({total_pages:e})}))},a.updateSortData=function(e){a.props.getData&&(a.setState({getDataInProgress:!0}),a.props.getData(a.props.type,a.state.curr_page,a.state.page_type,{sort_by:e,filters:a.state.filters},a.props.token).then((function(e){a.setState({items:e,getDataInProgress:!1})})).catch((function(){a.setState({getDataInProgress:!1})})))},a.toaster={},a.addToast=function(e){e.timeout=5e3,a.toaster.show(e)},a.addSuccessToast=function(e){a.addToast({message:e,intent:k.a.PRIMARY})},a.addWarnToast=function(e){a.addToast({message:e,intent:k.a.WARNING,action:{onClick:function(){return a.setState({isEditFormOpen:!0})},text:"Edit values"}})},a.addErrorToast=function(e){a.addToast({message:e,intent:k.a.DANGER})},a.refHandlers={toaster:function(e){return a.toaster=e}},a.updateTableData=function(){a.props.getData&&a.props.token&&(a.setState({getDataInProgress:!0}),a.props.getData(a.props.type,a.state.curr_page,a.state.page_type,{sort_by:a.state.sort_by,filters:a.state.filters},a.props.token).then((function(e){a.validRequestMadeWithToken=!0,a.setState({items:e,getDataInProgress:!1}),a.setFieldNames()})).catch((function(e){a.setState({getDataInProgress:!1})}))),a.props.getPages&&a.props.getPages(a.props.type,a.state.page_type,a.state.filters,a.props.token).then((function(e){a.setState({total_pages:e})}))},a.setFieldNamesFromData=function(e){var t=[];Object.keys(e[0]).forEach((function(e){"model"===e?(t.push("model__vendor"),t.push("model__model_number")):"rack"===e?(t.push("rack"),t.push("rack__datacenter__name")):"id"!==e&&"decommissioned_id"!==e&&"network_ports"!==e&&"comment"!==e&&"power_connections"!==e&&"mac_addresses"!==e&&"network_connections"!==e&&"network_graph"!==e&&"is_admin"!==e&&t.push(e)})),a.setState({fields:t})},a.setFieldNames=function(){a.state.items&&a.state.items.length>0&&a.setFieldNamesFromData(a.state.items)},a.handleInlineButtonClick=function(e){(F(e)||j(e)||I(e)||U(e)||L(e))&&a.setState({editFormValues:e})},a.handleEditFormClose=function(){return a.setState({isEditFormOpen:!1})},a.getEditForm=function(){return s.a.createElement(na,Object.assign({},a.props,{isOpen:a.state.isEditFormOpen,initialValues:a.state.editFormValues,type:K.MODIFY,elementName:a.props.type,handleClose:a.handleEditFormClose,submitForm:a.getSubmitFormFunction(K.MODIFY)}))},a.getUserEditForm=function(){return s.a.createElement(na,Object.assign({},a.props,{isOpen:a.state.editUserFormOpen,userId:a.state.selected_userid,initialValues:a.state.editFormValues,type:K.MODIFY,elementName:a.props.type,handleClose:function(){a.setState({editUserFormOpen:!1})},submitForm:function(){a.setState({editUserFormOpen:!1}),a.successfulModification("User permissions successfully updated")}}))},a.getPowerOptions=function(){return s.a.createElement(S.i,Object.assign({className:_.a.DARK+" power-dialog"},a.props,{isOpen:a.state.isPowerOptionsOpen,onClose:function(){a.setState({isPowerOptionsOpen:!1})}}),s.a.createElement(pt,Object.assign({},a.props,{callback:function(){a.setState({isPowerOptionsOpen:!1})},asset:a.state.assetPower,shouldUpdate:!1,updated:function(){},assetIsDecommissioned:a.props.isDecommissioned})))},a.successfulModifcationWithWarning=function(e){a.updateTableData(),a.handleEditFormClose(),a.addWarnToast(e)},a.handleEditFormSubmit=function(e,t){return j(e)?Ye(e,t).then((function(e){a.successfulModification(e.data.success_message)})):F(e)?Xe(e,t,a.props.changePlan).then((function(e){e.data.warning_message?a.successfulModifcationWithWarning(e.data.warning_message):a.successfulModification(e.data.success_message)})):U(e)?Qe(e,t).then((function(e){a.props.updateChangePlans(!0),a.successfulModification(e.data.success_message)})):I(e)?at(e,t).then((function(e){a.successfulModification(e.data.success_message),a.props.updateDatacenters&&a.props.updateDatacenters()})):void 0},a.handleEditFormOpen=function(){a.setState({isEditFormOpen:!0})},a.getSubmitFormFunction=function(e){return a.handleEditFormSubmit},a.handleEditButtonClick=function(e){a.handleInlineButtonClick(e),a.handleEditFormOpen()},a.shouldShowColumn=function(e,t){return F(e)?D[t]&&"comment"!==t:"id"!==t&&"network_ports"!==t&&"comment"!==t&&"is_admin"!==t&&"decommissioned_id"!==t&&!R(e[t])},a.handleDeleteOpen=function(){return a.setState({openAlert:Me.DELETE})},a.handleDeleteCancel=function(){return a.setState({openAlert:Me.NONE})},a.handleDecommissionOpen=function(){return a.setState({openAlert:Me.DECOMMISSION})},a.handleDecommissionCancel=function(){return a.setState({openAlert:Me.NONE})},a.handleDelete=function(){var e;j(a.state.editFormValues)?e=Je(a.state.editFormValues,B(a.props.token)):F(a.state.editFormValues)?e=Ze(a.state.editFormValues,B(a.props.token)):I(a.state.editFormValues)?e=tt(a.state.editFormValues,B(a.props.token)):L(a.state.editFormValues)?e=nt(a.state.editFormValues,B(a.props.token)):U(a.state.editFormValues)&&(e=et(a.state.editFormValues,B(a.props.token))),e&&e.then((function(e){a.addSuccessToast(e.data.success_message),a.updateTableData(),a.handleDeleteCancel(),a.props.updateDatacenters&&a.props.updateDatacenters(),a.props.type===l.CHANGEPLANS&&a.props.updateChangePlans(!0)})).catch((function(e){a.addErrorToast(e.response.data.failure_message),a.handleDeleteCancel()}))},a.handleDecommission=function(){var e;F(a.state.editFormValues)&&(e=$e(a.state.editFormValues,B(a.props.token),a.props.changePlan)),e&&e.then((function(e){a.addSuccessToast(e.data.success_message),a.updateTableData(),a.handleDecommissionCancel(),a.props.updateDatacenters&&a.props.updateDatacenters()})).catch((function(e){a.addErrorToast(e.response.data.failure_message),a.handleDecommissionCancel()}))},a.handleDeleteButtonClick=function(e){a.handleInlineButtonClick(e),a.handleDeleteOpen()},a.handleDecommissionButtonClick=function(e){a.handleInlineButtonClick(e),a.handleDecommissionOpen()},a.handlePowerButtonClick=function(e){a.setState({isPowerOptionsOpen:!0,assetPower:e})},a.renderPermissionsButton=function(e){return s.a.createElement(S.b,{className:"button-table permissions-button",intent:"primary",icon:"edit",minimal:!0,text:"Edit Permissions",onClick:function(){a.setState({editUserFormOpen:!0,selected_userid:e.id,isEditFormOpen:!1})}})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.currDatacenter!==this.props.currDatacenter&&(this.setState({curr_page:1}),this.updatePageData(this.state.page_type,1)),e.token!==this.props.token&&this.updateTableData(),e.data!==this.props.data&&(this.setFieldNamesFromData(e.data),e.data&&this.setState({items:e.data}))}},{key:"handleSort",value:function(e){var t,a=this.state.sort_by,n=this.state.sorted_cols;this.state.sorted_cols.includes(e)?(t=!this.state.sort_by.find((function(t){return t.field===e})).ascending,a=a.filter((function(t){return t.field!==e})),this.setState({sort_by:a})):(t=!0,n.push(e)),a.push({field:e,ascending:t,id:e}),this.setState({sort_by:a,sorted_cols:n}),this.updateSortData(a)}},{key:"componentDidUpdate",value:function(){this.props.shouldUpdateData&&!this.props.data&&this.updateTableData(),this.props.token&&!this.validRequestMadeWithToken&&(this.updateTableData(),this.validRequestMadeWithToken=!0)}},{key:"componentDidMount",value:function(){this.props.data?(this.setState({items:this.props.data}),this.setFieldNames()):this.updateTableData()}},{key:"successfulModification",value:function(e){this.updateTableData(),this.handleEditFormClose(),this.addSuccessToast(e)}},{key:"routeToDetailView",value:function(e){G(e)&&e.related_asset?this.props.history.push(i.DASHBOARD+"/"+this.props.type+"/"+e.related_asset.id):this.props.history.push(i.DASHBOARD+"/"+this.props.type+"/"+e.id)}},{key:"render",value:function(){var e=this;return this.props.data&&0!==this.props.data.length&&0===this.state.items.length&&(this.setState({items:this.props.data}),this.setFieldNamesFromData(this.props.data)),s.a.createElement("div",{className:"tab-panel"},this.getEditForm(),this.getUserEditForm(),this.getPowerOptions(),s.a.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Delete",intent:"danger",isOpen:this.state.openAlert===Me.DELETE,onCancel:this.handleDeleteCancel,onConfirm:this.handleDelete},s.a.createElement("p",null,"Are you sure you want to delete?")),s.a.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Decommission",intent:"danger",isOpen:this.state.openAlert===Me.DECOMMISSION,onCancel:this.handleDecommissionCancel,onConfirm:this.handleDecommission},s.a.createElement("p",null,"Are you sure you want to decommission?")),s.a.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),s.a.createElement("div",{className:"filter-sort-panel"},this.props.disableFiltering?null:[s.a.createElement("div",{className:"filter-select"},s.a.createElement(dt,{handleAddFilter:this.addFilter,fields:this.state.fields})),s.a.createElement("div",{className:"table-options"},s.a.createElement(Be,{type:fe.FILTER,items:this.state.filters,renderItem:this.renderFilterItem}))],this.props.disableSorting?null:s.a.createElement("div",{className:"table-options"},s.a.createElement(Be,{type:fe.SORT,items:this.state.sort_by,renderItem:this.renderSortItem,onChange:this.updateSortOrder})),this.props.getPages?s.a.createElement("div",{className:"table-control"},s.a.createElement(S.l,{onChange:function(t){return e.handlePagingChange(t.target.value)}}," ",s.a.createElement("option",null," ",Ue.TEN),s.a.createElement("option",null,Ue.FIFTY),s.a.createElement("option",null,Ue.ALL)),this.state.page_type!==Ue.ALL?[s.a.createElement("span",null,s.a.createElement(S.m,{className:"icon",icon:Ie.a.CARET_LEFT,iconSize:S.m.SIZE_LARGE,onClick:function(){return e.previousPage()}})),s.a.createElement("span",null,"page ",this.state.curr_page," of ",this.state.total_pages),s.a.createElement("span",null,s.a.createElement(S.m,{className:"icon",icon:Ie.a.CARET_RIGHT,iconSize:S.m.SIZE_LARGE,onClick:function(){return e.nextPage()}}))]:null):null),s.a.createElement("div",{className:"table-wrapper"},s.a.createElement("table",{className:this.props.type!==l.DATACENTER&&this.props.type!==l.USER?"bp3-html-table bp3-interactive bp3-html-table-striped bp3-html-table-bordered element-table":"bp3-html-table bp3-html-table-striped bp3-html-table-bordered element-table"},s.a.createElement("thead",null,s.a.createElement("tr",null,this.props.type===l.ASSET&&this.state.fields&&(Object(ht.isNullOrUndefined)(this.props.data)||0===this.props.data.length)&&this.state.fields.length>0?s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},this.props.isDecommissioned?null:s.a.createElement(S.g,{checked:this.state.selectedAll,onClick:function(t){var a=e.state.selected,n=!e.state.selectedAll;e.state.items.forEach((function(e){F(e)&&(a.includes(e.asset_number)&&!n?a.splice(a.indexOf(e.asset_number),1):!a.includes(e.asset_number)&&n&&a.push(e.asset_number))})),e.setState({selectedAll:n,selected:a}),e.props.updateBarcodes&&e.props.updateBarcodes(e.state.selected)}}))):null,this.state.fields.map((function(t){return"model"===t?[s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},s.a.createElement("span",null,"model vendor"),e.getScrollIcon("model__vendor"))),s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},s.a.createElement("span",null,"model number"),e.getScrollIcon("model__model_number")))]:e.props.type===l.ASSET?s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},s.a.createElement("span",null,D[t]),e.getScrollIcon(t))):e.props.type===l.MODEL?s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},s.a.createElement("span",null,T[t]),e.getScrollIcon(t))):s.a.createElement("th",{className:"header-cell"},s.a.createElement("div",{className:"header-text"},s.a.createElement("span",null,t),e.getScrollIcon(t)))})),s.a.createElement("th",null))),this.state.items&&this.state.items.length>0?this.state.getDataInProgress?null:s.a.createElement("tbody",null,this.state.items.map((function(t){return s.a.createElement("tr",{key:t.id,onClick:e.props.type===l.DATACENTER||e.props.type===l.USER?function(){}:function(){e.routeToDetailView(t)},style:H(t)},e.props.type===l.ASSET&&F(t)&&(Object(ht.isNullOrUndefined)(e.props.data)||0===e.props.data.length)?s.a.createElement("th",{onClick:function(e){e.stopPropagation()}},e.props.isDecommissioned?null:s.a.createElement(S.g,{checked:e.state.selected.includes(t.asset_number),onClick:function(a){var n=e.state.selected;n.includes(t.asset_number)?(e.state.selectedAll&&e.setState({selectedAll:!1}),n.splice(n.indexOf(t.asset_number),1)):n.push(t.asset_number),e.setState({selected:n}),e.props.updateBarcodes&&e.props.updateBarcodes(e.state.selected),a.stopPropagation()}})):null,Object.entries(t).map((function(a){var n=Object(je.a)(a,2),r=n[0],o=n[1];return j(o)?[s.a.createElement("td",{style:H(t)},o.vendor),s.a.createElement("td",{style:H(t)},o.model_number)]:x(o)?[s.a.createElement("td",{style:H(t)},o.row_letter+o.rack_num),s.a.createElement("td",{style:H(t)},o.datacenter.name)]:"display_color"===r?s.a.createElement("td",{style:{backgroundColor:o}}):e.shouldShowColumn(t,r)?s.a.createElement("td",{style:H(t)},o):null})),s.a.createElement("td",{onClick:function(e){e.stopPropagation()}},e.props.permissionState.admin&&L(t)?s.a.createElement("div",{className:"inline-buttons-user grant-admin-button permissions-button"}," ",e.renderPermissionsButton(t)):null,s.a.createElement("div",{className:"inline-buttons"},e.props.type===l.USER||e.props.data||e.props.isDecommissioned?null:s.a.createElement(S.b,{className:"button-table",intent:"primary",minimal:!0,icon:"edit",disabled:!!(e.props.changePlan&&e.props.type!==l.ASSET||e.props.type===l.CHANGEPLANS&&U(t)&&t.execution_time)||!(e.props.permissionState.admin||e.props.type===l.DATACENTER&&e.props.permissionState.asset_management||e.props.type===l.MODEL&&e.props.permissionState.model_management||e.props.type===l.ASSET&&e.props.permissionState.asset_management||e.props.type===l.ASSET&&F(t)&&e.props.permissionState.datacenter_permissions.includes(+t.rack.datacenter.id)),onClick:function(a){e.handleEditButtonClick(t),a.stopPropagation()}}),e.props.data||e.props.isDecommissioned?null:s.a.createElement(S.b,{className:"button-table",intent:"danger",minimal:!0,icon:e.props.type===l.ASSET?"remove":"trash",disabled:!!(e.props.changePlan&&e.props.type!==l.ASSET||e.props.type===l.CHANGEPLANS&&U(t)&&t.execution_time)||!(e.props.permissionState.admin||e.props.type===l.DATACENTER&&e.props.permissionState.asset_management||e.props.type===l.MODEL&&e.props.permissionState.model_management||e.props.type===l.ASSET&&e.props.permissionState.asset_management||e.props.type===l.ASSET&&F(t)&&e.props.permissionState.datacenter_permissions.includes(+t.rack.datacenter.id)),onClick:e.props.type===l.ASSET?function(a){e.handleDecommissionButtonClick(t),a.stopPropagation()}:function(a){e.handleDeleteButtonClick(t),a.stopPropagation()}}),F(t)&&t.rack.is_network_controlled&&!e.props.isDecommissioned?s.a.createElement(S.b,{className:"button-table",intent:"warning",minimal:!0,icon:"offline",disabled:!!e.props.changePlan,onClick:function(a){e.handlePowerButtonClick(t),a.stopPropagation()}}):null)," "))}))):null),this.state.getDataInProgress?s.a.createElement(S.z,{className:"table-spinner",size:S.z.SIZE_STANDARD}):null,this.state.items&&0!==this.state.items.length||this.state.getDataInProgress?null:s.a.createElement(S.e,{icon:Ie.a.ERROR,title:"No "+this.props.type})))}}]),t}(s.a.Component),gt=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,changePlan:e.changePlan,permissionState:e.permissionState}}),(function(e){return{updateChangePlans:function(t){return e(q(t))}}}))(Object(v.f)(ft));function Et(e,t){return t.admin||e===l.DATACENTER&&t.asset_management||e===l.MODEL&&t.model_management||e===l.ASSET&&(t.asset_management||t.datacenter_permissions.length>0)||e===l.CHANGEPLANS}var vt=a(459),bt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={isOpen:!1,filters:[],fileNameIsOpen:!1,fileName:"",networkFileName:"",updateTable:!1,barcodes:[],isDecommissioned:!1},a.getExportData=function(e,t,n,s,r){var o,i={headers:{Authorization:"Token "+n}},l=t.slice();"assets"===e&&(a.props.currDatacenter&&a.props.currDatacenter.name!==Tt.name&&(o=a.props.currDatacenter.name,l.push({id:"",field:"rack__datacenter__name",filter_type:Le.TEXT,filter:{value:o,match_type:Ge.EXACT}})));var c={sort_by:[],filters:l};y.a.post(C+"api/"+e+"/bulk-export",c,i).then((function(e){return vt(e.data.export_csv,s),0})).catch((function(e){return a.addErrorToast("Failed to export data to "+s)})),"assets"===e&&y.a.post(C+"api/"+e+"/network-bulk-export",c,i).then((function(e){return vt(e.data.export_csv,r),0})).catch((function(e){return a.addErrorToast("Failed to export data to "+s)}))},a.getPages=function(e,t,n,s){var r={page_size:t};a.props.changePlan&&(r.change_plan=a.props.changePlan.id);var o,i={headers:{Authorization:"Token "+s},params:r},l=n.slice();a.props.currDatacenter&&a.props.currDatacenter.name!==Tt.name&&(o=a.props.currDatacenter.name,l.push({id:"",field:"rack__datacenter__name",filter_type:Le.TEXT,filter:{value:o,match_type:Ge.EXACT}}));var c=a.state.isDecommissioned?"api/assets/pages-decommissioned":"api/"+e+"/pages";return y.a.post(C+c,{filters:l},i).then((function(e){return e.data.page_count}))},a.getElementData=function(e,t,n,s,r){a.handleDataUpdate(!1);var o=n===Ue.ALL?{}:{page_size:n,page:t};a.props.changePlan&&(o.change_plan=a.props.changePlan.id);var i,l={headers:{Authorization:"Token "+r},params:o},c=JSON.parse(JSON.stringify(s)),u=c.filters;a.props.currDatacenter&&a.props.currDatacenter.name!==Tt.name&&(i=a.props.currDatacenter.name,u.push({id:"",field:"rack__datacenter__name",filter_type:Le.TEXT,filter:{value:i,match_type:Ge.EXACT}}),c=Re(c,{filters:u}));var d=a.state.isDecommissioned?C+"api/assets/get-many-decommissioned":C+"api/"+e+"/get-many";return y.a.post(d,c,l).then((function(t){return t.data[e]}))},a.handleDataUpdate=function(e){a.setState({updateTable:e})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleClose=function(){return a.setState({isOpen:!1})},a.createModel=function(e,t){return y.a.post(C+"api/models/add",e,t).then((function(e){a.handleDataUpdate(!0),a.handleClose(),a.addSuccessToast(e.data.success_message)}))},a.createAsset=function(e,t){var n;return n=a.props.changePlan?{headers:t.headers,params:{change_plan:a.props.changePlan.id}}:t,y.a.post(C+"api/assets/add",e,n).then((function(e){a.handleDataUpdate(!0),a.handleClose(),e.data.warning_message?a.addWarnToast("Created asset. "+e.data.warning_message):a.addSuccessToast(e.data.success_message)}))},a.addWarnToast=function(e){a.addToast({message:e,intent:k.a.WARNING})},a.createDatacenter=function(e,t){return y.a.post(C+"api/datacenters/add",e,t).then((function(e){a.handleDataUpdate(!0),a.handleClose(),a.addSuccessToast(e.data.success_message),a.props.updateDatacenters&&a.props.updateDatacenters()}))},a.createUser=function(e,t){return y.a.post(C+"api/users/add",e,t).then((function(e){a.handleDataUpdate(!0),a.handleClose(),a.addSuccessToast(e.data.success_message)}))},a.createChangePlan=function(e,t){return y.a.post(C+"api/change-plans/add",e,t).then((function(e){a.props.updateChangePlans(!0),a.handleDataUpdate(!0),a.handleClose(),a.addSuccessToast(e.data.success_message)}))},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.changePlan!==this.props.changePlan&&this.handleDataUpdate(!0)}},{key:"addSuccessToast",value:function(e){this.addToast({message:e,intent:k.a.PRIMARY})}},{key:"addErrorToast",value:function(e){this.addToast({message:e,intent:k.a.DANGER})}},{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"element-tab"},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),n.createElement("div",null,this.props.datacenters&&this.props.onDatacenterSelect?n.createElement(S.e,null,n.createElement(S.k,{label:"Datacenter",inline:!0},n.createElement(Ae,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:this.props.datacenters,onItemSelect:function(t){e.props.onDatacenterSelect(t)},itemRenderer:ke,itemPredicate:ue,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",text:this.props.currDatacenter&&this.props.currDatacenter.name?this.props.currDatacenter.name:"All datacenters"})))):null),this.state.isDecommissioned?n.createElement(S.e,{icon:"warning-sign"},n.createElement(S.k,{label:"Showing decommissioned assets",inline:!0},n.createElement(S.c,{onClick:function(){e.setState({isDecommissioned:!1}),e.handleDataUpdate(!0)}},"View Live Assets"))):n.createElement("div",{className:"element-tab-buttons"},this.props.element!==l.USER&&this.props.element!==l.DATACENTER&&this.props.element!==l.CHANGEPLANS?n.createElement(S.b,{className:"add",text:"Export Table Data",disabled:!!this.props.changePlan,icon:"import",minimal:!0,onClick:function(){e.setState({fileNameIsOpen:!0})}}):n.createElement("p",null),this.props.element===l.ASSET||this.props.element===l.MODEL?n.createElement(S.b,{disabled:!!this.props.changePlan||!Et(this.props.element,this.props.permissionState),onClick:function(){e.props.history.push("/dashboard/bulk-upload/"+(e.props.element===l.MODEL?"models":"assets"))},className:"add",icon:"export",text:"Add from CSV file",minimal:!0}):null,n.createElement(S.a,{cancelButtonText:"Cancel",className:_.a.DARK,intent:k.a.PRIMARY,confirmButtonText:"Confirm Export",isOpen:this.state.fileNameIsOpen,onCancel:function(){e.setState({fileNameIsOpen:!1})},onConfirm:function(){if(""===e.state.fileName||""===e.state.networkFileName&&e.props.element===l.ASSET||""===e.state.fileName&&e.props.element===l.MODEL)e.addErrorToast("Please provide filenames for both files");else{var t=/.*\.(\w+)/,a=e.state.fileName.match(t),n=a?a[a.length-1]:null,s=e.state.networkFileName.match(t),r=s?s[s.length-1]:null;r&&("csv"!==n||"csv"!==r)||!r&&"csv"!==n?e.addErrorToast("Filenames must end in .csv"):r&&(0===e.state.fileName.split(".")[0].length||0===e.state.networkFileName.split(".")[0].length)||!r&&0===e.state.fileName.split(".")[0].length?e.addErrorToast(".csv file must have non-empty name"):(e.getExportData(e.props.element.slice(0,-1)+"s",e.state.filters,e.props.token,e.state.fileName,e.state.networkFileName),e.setState({fileNameIsOpen:!1,fileName:"",networkFileName:""}))}}},n.createElement("p",null,'Please enter a filename ending in ".csv" for the following data:'),n.createElement(S.k,{label:this.props.element+":"},n.createElement(S.n,{onChange:function(t){e.setState({fileName:t.currentTarget.value})},fill:!0,type:"text"})),this.props.element===l.ASSET?n.createElement("div",null,n.createElement(S.k,{label:"network connections:"},n.createElement(S.n,{onChange:function(t){e.setState({networkFileName:t.currentTarget.value})},fill:!0,type:"text"}))):null),n.createElement(S.b,{className:"add",text:"Add "+this.props.element.slice(0,-1),icon:"add",minimal:!0,intent:k.a.PRIMARY,onClick:this.handleOpen,disabled:!(this.props.element===l.ASSET||!this.props.changePlan)||!Et(this.props.element,this.props.permissionState)}),this.props.element===l.ASSET?this.renderBarcodeButton():null,this.props.element===l.ASSET?n.createElement(S.c,{onClick:function(){e.setState({isDecommissioned:!0}),e.handleDataUpdate(!0)},text:"View Decommissioned",minimal:!0,icon:"archive"}):null,n.createElement(na,Object.assign({},this.props,{type:K.CREATE,elementName:this.props.element,submitForm:this.props.element===l.MODEL?this.createModel:this.props.element===l.ASSET?this.createAsset:this.props.element===l.DATACENTER?this.createDatacenter:this.props.element===l.CHANGEPLANS?this.createChangePlan:this.createUser,isOpen:this.state.isOpen,handleClose:this.handleClose}))),n.createElement("div",null,n.createElement(gt,{datacenters:this.props.datacenters,updateDatacenters:this.props.updateDatacenters,type:this.props.element,getData:this.getElementData,getPages:this.getPages,updateBarcodes:function(t){e.setState({barcodes:t})},callback:function(t){e.setState({filters:t})},shouldUpdateData:this.state.updateTable,disableSorting:this.props.element===l.DATACENTER,disableFiltering:this.props.element===l.DATACENTER,currDatacenter:this.props.currDatacenter,isDecommissioned:this.state.isDecommissioned})))}},{key:"renderBarcodeButton",value:function(){var e=this;return 0===this.state.barcodes.length?n.createElement(S.b,{className:"add",text:"Print Barcodes for Selected Assets",icon:"barcode",minimal:!0,disabled:!0,onClick:function(){}}):n.createElement(b.b,{target:"_blank",to:{pathname:i.BARCODE_PRINT,state:null}},n.createElement(S.b,{className:"add",text:"Print Barcodes for Selected Assets",icon:"barcode",style:{color:"white"},minimal:!0,disabled:0===this.state.barcodes.length,onClick:function(t){var a;a="";for(var n=0;n<e.state.barcodes.length-1;n++)a=a+e.state.barcodes[n]+",";a+=e.state.barcodes[e.state.barcodes.length-1],localStorage.setItem("barcodes",a)}}))}}]),t}(n.Component),kt=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,permissionState:e.permissionState,changePlan:e.changePlan}}),(function(e){return{updateChangePlans:function(t){return e(q(t))}}}))(bt),_t=(a(460),{log:function(){},warn:function(){}}),St=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={isDeleteOpen:!1},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.handleDeleteCancel=function(){return a.setState({isDeleteOpen:!1})},a.handleDeleteOpen=function(){return a.setState({isDeleteOpen:!0})},a.handleDelete=function(e,t){var n={letter_start:e,num_start:t};y.a.post(C+"api/racks/delete",n,B(a.props.token)).then((function(e){a.setState({isDeleteOpen:!1})})).catch((function(e){a.handleDeleteCancel(),a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))},a.componentDidMount=function(){a.props.location.pathname===i.RACK_PRINT&&(_t.log(a.props.location),window.print())},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getRows",value:function(e){for(var t=this,a=[],s=0,r=e.rack.height,o=Object.assign([],e.assets),l=+r;s<l;){if(o.length>0&&s>+o[0].rack_position){var c=o.shift();_t.warn("CONFLICTING ASSETS ",c)}o.length>0&&o[0]&&s===+o[0].rack_position-1?function(){var e=+o[0].model.height,r=+o[0].id;if(e+s>l)_t.warn("ASSET OUT OF RANGE ",o[0]),s++,a.unshift(n.createElement("tr",{className:"rack-row"},n.createElement("td",{className:"cell empty"})));else{s=e+s;var c=o[0].hostname?o[0].hostname:" ";a.unshift(n.createElement("tr",{className:"rack-row",style:{lineHeight:1*e,backgroundColor:o[0].model.display_color}},n.createElement("td",{className:"cell",onClick:function(){return t.props.history.push(i.ASSETS+"/"+r)}},o[0].model.vendor+" "+o[0].model.model_number+" | "+c))),o.shift()}}():(s++,a.unshift(n.createElement("tr",{className:"rack-row"},n.createElement("td",{className:"cell empty"}))))}return a}},{key:"getUnitRows",value:function(e){for(var t=+e.rack.height,a=[],s=1;s<=t;s++)a.unshift(n.createElement("tr",{className:"rack-row",style:{lineHeight:1}},n.createElement("td",{className:"cell unit"}," ",s,"U ")));return a}},{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"render",value:function(){var e=this,t=this.props.location.pathname===i.RACK_PRINT?JSON.parse(localStorage.getItem("racks")):this.props.racks;return this.props.location&&this.props.location.state&&_t.log(this.props.location),n.createElement("div",{className:_.a.DARK},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),this.props.loading?n.createElement(S.z,{className:"center",intent:"primary",size:S.z.SIZE_STANDARD}):n.createElement("div",{className:"rack-container"},t.map((function(t){return n.createElement("span",null,n.createElement("div",{className:"rack-parent"},n.createElement(S.a,{className:_.a.DARK,cancelButtonText:"Cancel",confirmButtonText:"Delete",intent:"danger",isOpen:e.state.isDeleteOpen,onCancel:e.handleDeleteCancel,onConfirm:function(){return e.handleDelete(t.rack.row_letter,t.rack.rack_num)}}," ",n.createElement("p",null,"Are you sure you want to delete?")),n.createElement("div",{className:_.a.DARK+" rack"},n.createElement("table",{className:" bp3-html-table bp3-interactive rack-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{className:" cell header"},"Rack ",t.rack.row_letter,t.rack.rack_num))),n.createElement("tbody",null,e.getRows(t))),n.createElement("table",{className:"bp3-html-table loc-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{className:" cell header"}," (U)"))),n.createElement("tbody",null,e.getUnitRows(t))))))}))))}}]),t}(n.PureComponent),wt=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin}}))(Object(v.f)(St)),Ot=a(733),yt={log:function(){}},Nt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={viewRange:!1,values:{},errors:[]},a.handleSwitchChange=Object(Ot.a)((function(e){a.setState({viewRange:e}),e||a.setState({values:Re(a.state.values,{letter_end:void 0,num_end:void 0})})})),a.handleChange=function(e){a.setState({values:Re(a.state.values,Object(Te.a)({},e))})},a.handleSubmit=function(e){a.setState({errors:[]}),e.preventDefault();var t=a.state.values;Object.entries(t).forEach((function(e){var a=Object(je.a)(e,2),n=a[0];""===a[1]&&(t[n]=void 0)}));var n=B(a.props.token),s=a.props.submitForm(t,n,!0);s&&s.catch((function(e){yt.log(e.response.data.failure_message);var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t})}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){yt.log(e.currDatacenter,this.props.currDatacenter),e.currDatacenter!==this.props.currDatacenter&&(yt.log("NEW DATACENTER",e),this.setState({values:{letter_start:"",letter_end:"",num_start:"",num_end:"",datacenter:""}}))}},{key:"renderRackOptions",value:function(e){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return yt.log(this.state.values),n.createElement("div",null,this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("form",{onSubmit:this.handleSubmit,className:"rack-form bp3-form-group"},n.createElement("div",{className:"rack-select"},n.createElement(lt,{className:"rack-field",handleChange:this.handleChange,values:this.state.values}),n.createElement("div",{className:"rack-field "},n.createElement(S.c,{className:"button",type:"submit"},"Submit"),this.props.loading?n.createElement("div",null,n.createElement("p",null,"processing request... "),n.createElement(S.z,{size:S.z.SIZE_SMALL})):null))))}}]),t}(n.Component),Ct=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin}}))(Object(v.f)(Nt)),At={log:function(){}},Dt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={isOpen:!1,isDeleteOpen:!1,selectedRackRange:{},deleteRackInfo:{},headers:{},isConfirmationOpen:!1,racks:[],loading:!1,viewAll:!1,submitInProgress:!1},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.handleDeleteCancel=function(){return a.setState({isDeleteOpen:!1})},a.handleDeleteOpen=function(){return a.setState({isDeleteOpen:!0})},a.handleClose=function(){return a.setState({isOpen:!1})},a.handleConfirmationCancel=function(){return a.setState({isConfirmationOpen:!1})},a.handleConfirmationOpen=function(){return a.setState({isConfirmationOpen:!0})},a.viewRackForm=function(e,t,n){a.setState({loading:!0,selectedRackRange:e});var s=Re(e,{datacenter:a.props.currDatacenter.id});return y.a.post(C+"api/racks/get",s,t).then((function(e){a.setState({racks:e.data.racks,loading:!1})})).catch((function(e){a.setState({loading:!1,racks:[]}),n&&a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))},a.handleOpen=function(){a.setState({isOpen:!0}),At.log(a.state)},a.deleteRack=function(e,t){var n=Re(e,{datacenter:a.props.currDatacenter.id});a.setState({deleteRackInfo:n,headers:t}),a.handleConfirmationOpen()},a.actuallyDelete=function(){return a.setState({submitInProgress:!0}),y.a.post(C+"api/racks/delete",a.state.deleteRackInfo,a.state.headers).then((function(e){a.addToast({message:e.data.success_message,intent:k.a.PRIMARY}),a.updateRackData(!1),a.setState({isDeleteOpen:!1,isConfirmationOpen:!1,submitInProgress:!1})})).catch((function(e){At.log(e.response),a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER}),a.setState({isDeleteOpen:!0,isConfirmationOpen:!1,submitInProgress:!1})}))},a.updateRackData=function(e){a.state.selectedRackRange.num_start?a.viewRackForm(a.state.selectedRackRange,B(a.props.token),e):a.state.viewAll&&a.getAllRacks(a.props.currDatacenter)},a.createRack=function(e,t){a.setState({submitInProgress:!0});var n=Re(e,{datacenter:a.props.currDatacenter.id});return y.a.post(C+"api/racks/create",n,t).then((function(e){a.setState({isOpen:!1,submitInProgress:!1}),a.updateRackData(!0),a.addToast({message:e.data.success_message,intent:k.a.PRIMARY})})).catch((function(e){a.setState({submitInProgress:!1}),a.addErrorToast(e.data.failure_message)}))},a.addErrorToast=function(e){a.addToast({message:e,intent:k.a.DANGER})},a.getAllRacks=function(e){At.log(a.props),a.setState({loading:!0,viewAll:!0});var t={headers:{Authorization:"Token "+a.props.token},params:{datacenter:e.id}};y.a.get(C+"api/racks/get-all",t).then((function(e){At.log("GOT RACKS",e.data,a.state.racks),a.setState({racks:e.data.racks,loading:!1})})).catch((function(e){At.log("failed to get racks"),a.setState({loading:!1,racks:[]}),a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"componentWillReceiveProps",value:function(e){e.currDatacenter!==this.props.currDatacenter&&this.setState({racks:[],selectedRackRange:{}})}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"rack-tab"},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),n.createElement("div",null,n.createElement(S.e,null,n.createElement(S.k,{label:"Datacenter",inline:!0},n.createElement(Ae,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:this.props.datacenters,onItemSelect:function(t){e.props.onDatacenterSelect(t)},itemRenderer:ke,itemPredicate:ue,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",text:this.props.currDatacenter&&this.props.currDatacenter.name?this.props.currDatacenter.name:"All datacenters"}))))),n.createElement(na,Object.assign({},this.props,{loading:this.state.submitInProgress,type:K.CREATE,elementName:l.RACK,submitForm:this.createRack,isOpen:this.state.isOpen,handleClose:this.handleClose})),n.createElement(na,Object.assign({},this.props,{loading:this.state.submitInProgress,type:K.DELETE,elementName:l.RACK,submitForm:this.deleteRack,isOpen:this.state.isDeleteOpen,handleClose:this.handleDeleteCancel})),n.createElement(S.a,{className:_.a.DARK,cancelButtonText:"Cancel",confirmButtonText:"Delete",intent:"danger",isOpen:this.state.isConfirmationOpen,onCancel:this.handleConfirmationCancel,onConfirm:this.actuallyDelete},n.createElement("p",null,"Are you sure you want to delete?")),this.props.currDatacenter&&this.props.currDatacenter.name!==Tt.name?n.createElement("div",{className:"rack-tab-panel"},this.props.changePlan?n.createElement(S.e,{intent:k.a.WARNING,title:"Rack Management on a change plan"},n.createElement("em",null,"All changes made to racks will be live in the database ")):null,n.createElement("div",{className:" element-tab-buttons"},n.createElement(S.b,{className:"add",text:"Add Rack(s)",icon:"add",minimal:!0,intent:k.a.PRIMARY,onClick:this.handleOpen,disabled:!(this.props.permissionState.admin||this.props.permissionState.asset_management||this.props.permissionState.datacenter_permissions.includes(+this.props.currDatacenter.id))}),n.createElement(S.b,{className:"add ",text:"Delete Rack(s)",icon:"trash",minimal:!0,intent:k.a.DANGER,onClick:this.handleDeleteOpen,disabled:!(this.props.permissionState.admin||this.props.permissionState.asset_management||this.props.permissionState.datacenter_permissions.includes(+this.props.currDatacenter.id))})),n.createElement(S.f,null,n.createElement("div",{className:"rack-view-options"},n.createElement(S.c,{className:"all-racks",text:"View All Racks",onClick:function(t){return e.getAllRacks(e.props.currDatacenter)}}),n.createElement("p",{className:"or"},"or "),n.createElement(Ct,{currDatacenter:this.props.currDatacenter,submitForm:this.viewRackForm})))):n.createElement(S.e,{title:"No Datacenter Selected"},n.createElement("em",null,"Please select a datacenter to view rack information")),0!==this.state.racks.length?n.createElement(b.b,{target:"_blank",to:{pathname:i.RACK_PRINT,state:this.state.racks}},n.createElement(S.c,{className:"print-racks",icon:"print",text:"Print Racks Page",onClick:function(t){At.log("storing racks"),localStorage.setItem("racks",JSON.stringify(e.state.racks))}})):null,n.createElement("div",{id:"rack-view-print"},n.createElement(wt,{racks:this.state.racks,loading:this.state.loading})))}}]),t}(n.Component),Pt=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,changePlan:e.changePlan,permissionState:e.permissionState}}))(Object(v.f)(Dt)),Tt={id:"",name:"All datacenters",abbreviation:"ALL"},Rt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={datacenters:[],currDatacenter:Tt},a.onDatacenterSelect=function(e){a.setState({currDatacenter:e})},a.getDatacenters=function(){var e=B(a.props.token);y.a.post(C+"api/datacenters/get-many",{},e).then((function(e){var t=e.data.datacenters;t.push(Tt),a.setState({datacenters:t})})).catch((function(e){}))},a.componentDidMount=function(){a.getDatacenters()},a.getTabName=function(e){if("/dashboard"===e)return"racks";var t=new RegExp("dashboard/(.*$)").exec(e);return t?t[1]:void 0},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return n.createElement(S.B,{className:_.a.DARK+" element-view ",animate:!0,id:"ElementViewer",key:"vertical",selectedTabId:this.getTabName(this.props.location.pathname),renderActiveTabPanelOnly:!1,vertical:!0,large:!0,onChange:function(t){return e.props.history.push("/dashboard/"+t)}},n.createElement(S.A,{className:"tab",id:"racks",title:"Racks",panel:n.createElement(Pt,{datacenters:this.state.datacenters,currDatacenter:this.state.currDatacenter,onDatacenterSelect:this.onDatacenterSelect})}),n.createElement(S.A,{className:"tab do-not-print",id:"assets",title:"Assets",panel:n.createElement(kt,Object.assign({datacenters:this.state.datacenters,currDatacenter:this.state.currDatacenter,onDatacenterSelect:this.onDatacenterSelect},this.props,{element:l.ASSET,isActive:!1}))}),n.createElement(S.A,{className:"tab do-not-print",id:"models",title:"Models",panel:n.createElement(kt,Object.assign({},this.props,{element:l.MODEL}))}),n.createElement(S.A,{className:"tab do-not-print",id:"datacenters",title:"Datacenters",disabled:!(this.props.permissionState.admin||this.props.permissionState.asset_management),panel:n.createElement(kt,Object.assign({},this.props,{updateDatacenters:this.getDatacenters,element:l.DATACENTER}))}),n.createElement(S.B.Expander,null))}}]),t}(n.Component),jt=Object(E.b)((function(e){return{isAdmin:e.admin,permissionState:e.permissionState,token:e.token}}))(Rt),It=a(87),xt=a.n(It),Ft=function(e){function t(){var e,a;Object(p.a)(this,t);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).initialState=a.props.initialValues?JSON.parse(JSON.stringify(a.props.initialValues)):{},a.setPowerPortInputState=function(){var e={};return a.state.values&&a.state.values.power_connections&&Object.keys(a.state.values.power_connections).forEach((function(t){e[t]=!0})),e},a.initialGetRacks=!1,a.gettingAssetsInProgress=!1,a.gettingRacksInProgress=!1,a.gettingPowerPortsInProgress=!1,a.state={values:a.initialState,currDatacenter:a.initialState.rack?a.initialState.rack.datacenter:a.props.currDatacenter===Tt?void 0:a.props.currDatacenter,racks:[],models:[],errors:[],users:[],assets:[],left_ports:[],right_ports:[],power_ports:{},power_ports_default:{},isAlertOpen:!1,warningMessage:"",selectedValue:void 0,loading:!1},a.mapAssetObject=function(e){var t=e.asset_number,a=e.hostname,n=e.id,s=e.rack_position,r=e.owner,o=e.mac_addresses,i=e.network_connections,l=e.power_connections,c=e.comment;return{asset_number:t,model:e.model?e.model.id:null,rack:e.rack?e.rack.id:null,hostname:a,id:n,rack_position:s,owner:r,comment:c,mac_addresses:o,network_connections:i,power_connections:l}},a.handleSubmit=function(e){if(e.preventDefault(),a.state.values){if(a.setState({errors:[],loading:!0}),!a.validateMacAddresses())return void xt()(".bp3-overlay-scroll-container").scrollTop(0);var t=a.state.values;""===a.state.values.hostname&&delete t.hostname,""===a.state.values.asset_number&&delete t.asset_number,a.props.initialValues&&(t.id=a.props.initialValues.id),a.setState({values:t});var n=a.props.submitForm(a.mapAssetObject(t),B(a.props.token));n&&(n.then((function(e){return a.setState({loading:!1})})),n.catch((function(e){xt()(".bp3-overlay-scroll-container").scrollTop(0);var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t,loading:!1})})))}},a.validateMacAddresses=function(){var e=!0;return Object.entries(a.state.values.mac_addresses).forEach((function(t){var n=Object(je.a)(t,2),s=n[0],r=n[1];if(""===r)delete a.state.values.mac_addresses[s];else if(!se(r)){var o=[];e=!1,o.push('Mac Address "'+r+'" for "'+s+'" is invalid.'),a.setState({errors:o,loading:!1})}})),e},a.handleChange=function(e){a.setState({values:Re(a.state.values,Object(Te.a)({},e))})},a.getUsers=function(){var e=B(a.props.token);y.a.get(C+"api/usernames",e).then((function(e){a.setState({users:e.data.usernames})})).catch((function(e){}))},a.getRacks=function(e){if(e){a.gettingRacksInProgress=!0;var t={headers:{Authorization:"Token "+a.props.token},params:{datacenter:e?e.id:void 0}};y.a.get(C+"api/racks/summary",t).then((function(e){a.initialGetRacks=!0,a.gettingRacksInProgress=!1,a.setState({racks:e.data.racks})})).catch((function(e){}))}},a.getModels=function(){a.getElementData(l.MODEL,1,Ue.ALL,{},a.props.token).then((function(e){a.setState({models:e})}))},a.getValidAssets=function(e){a.gettingAssetsInProgress=!0;var t,n={},s=[];e&&e.name!==Tt.name&&(t=e.name,s.push({id:"",field:"rack__datacenter__name",filter_type:Le.TEXT,filter:{value:t,match_type:Ge.EXACT}}),n=Re(n,{filters:s})),a.getElementData(l.ASSET,1,Ue.ALL,n,a.props.token).then((function(e){var t=e;t=t.filter((function(e){return""!==e.hostname&&e.hostname!==a.state.values.hostname})),a.setState({assets:t}),a.gettingAssetsInProgress=!1}))},a.getPowerButtonStatus=function(e,t){if(a.state.values.power_connections&&a.state.values.power_connections[t]){var n=t;return e===a.state.values.power_connections[n].left_right}return!1},a.shouldDisablePowerPort=function(e){return!a.state.values.rack||!(a.state.values.power_connections&&a.state.values.power_connections[e])},a.getPortsForSide=function(e){if(a.state.values.power_connections&&a.state.values.power_connections[e]&&Object.keys(a.state.power_ports).length>0){var t=e;return a.state.values.power_connections[t].left_right===c.LEFT?a.state.power_ports.left_available.map(String):a.state.power_ports.right_available.map(String)}return[]},a.setDefaultPortValues=function(e,t){var n=a.state.values.power_connections;t?1===e?(n[e]=Re(n,{left_right:c.LEFT,port_number:a.state.power_ports.left_suggest}),a.setState({values:Re(a.state.values,{power_connections:n})})):2===e&&(n[e]=Re(n,{left_right:c.RIGHT,port_number:a.state.power_ports.right_suggest}),a.setState({values:Re(a.state.values,{power_connections:n})})):(n[e]=Re(n,{left_right:void 0,port_number:void 0}),a.setState({values:Re(a.state.values,{power_connections:n})}))},a.changeCheckBoxState=function(e,t){var n=Object(Te.a)({},a.state.power_ports_default);n[e]=t,a.setState({power_ports_default:n})},a.clearPowerSelection=function(e){var t=a.state.values.power_connections;t&&t[e]&&(a.changeCheckBoxState(e,!1),t[e]={},a.setState({values:Re(a.state.values,{power_connections:t})}))},a.getPowerPortFields=function(){if(a.state.values.model&&a.state.values.model.num_power_ports&&parseInt(a.state.values.model.num_power_ports,10)>0){for(var e=parseInt(a.state.values.model.num_power_ports,10),t=[],s=function(e){t.push(n.createElement("div",{className:"power-form-container"},n.createElement("div",null,n.createElement("i",{className:"section-title"},"Power Port: ",e),1===e||2===e?n.createElement("div",null,n.createElement(S.g,{className:"checkbox",disabled:Object(ht.isNullOrUndefined)(a.state.values.rack),checked:a.state.power_ports_default[e],label:"Use Suggested Values ",onChange:function(t){a.setDefaultPortValues(e,!a.state.power_ports_default[e]),a.changeCheckBoxState(e,!a.state.power_ports_default[e])}})):null),n.createElement("div",null,n.createElement(S.d,{className:"power-form-element",fill:!1,style:{marginTop:5}},n.createElement(S.c,{active:a.getPowerButtonStatus(c.LEFT,e),text:"Left",disabled:Object(ht.isNullOrUndefined)(a.state.values.rack),onClick:function(t){var n=a.state.values.power_connections;n&&(n[e]=Re(n[e],{left_right:c.LEFT,port_number:null}),a.changeCheckBoxState(e,!1),a.setState({values:Re(a.state.values,{power_connections:n})}))}}),n.createElement(S.c,{active:a.getPowerButtonStatus(c.RIGHT,e),text:"Right",disabled:Object(ht.isNullOrUndefined)(a.state.values.rack),onClick:function(t){var n=a.state.values.power_connections;n[e]=Re(n[e],{left_right:c.RIGHT,port_number:null}),a.changeCheckBoxState(e,!1),a.setState({values:Re(a.state.values,{power_connections:n})})}}),n.createElement(Oe,{className:"power-form-element",popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},disabled:a.shouldDisablePowerPort(e),items:a.getPortsForSide(e),onItemSelect:function(t){a.changeCheckBoxState(e,!1);var n=a.state.values.power_connections;n[e]=Re(n[e],{port_number:t}),a.setState({values:Re(a.state.values,{power_connections:n})})},itemRenderer:ve,itemPredicate:le,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{disabled:a.shouldDisablePowerPort(e),rightIcon:"caret-down",text:a.state.values.power_connections&&a.state.values.power_connections[e]&&a.state.values.power_connections[e].port_number?a.state.values.power_connections[e].port_number:"PDU Port"})),n.createElement(S.c,{icon:Ie.a.DELETE,minimal:!0,onClick:function(){a.clearPowerSelection(e)}})))))},r=1;r<=e;r++)s(r);return t}},a.getSelectedPort=function(e){if(a.state.values.network_connections){var t=a.state.values.network_connections.find((function(t){return t.source_port===e}));if(t)return t.destination_port}},a.handleChangeDecline=function(){a.setState({isAlertOpen:!1})},a.handleChangeAccept=function(){a.state.selectedValue&&I(a.state.selectedValue)&&a.handleDatacenterSelect(a.state.selectedValue),a.state.selectedValue&&x(a.state.selectedValue)&&a.handleRackSelect(a.state.selectedValue),a.setState({isAlertOpen:!1})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getPowerPortAvailability",value:function(e){var t=this;this.gettingPowerPortsInProgress=!0;var a={id:e.id};this.props.changePlan&&(a.change_plan=this.props.changePlan.id);var n={headers:{Authorization:"Token "+this.props.token},params:a};y.a.get(C+"api/power/availability",n).then((function(e){t.gettingPowerPortsInProgress=!1,t.setState({power_ports:e.data})}))}},{key:"getElementData",value:function(e,t,a,n,s){var r=a===Ue.ALL?{}:{page_size:a,page:t};this.props.changePlan&&(r.change_plan=this.props.changePlan.id);var o={headers:{Authorization:"Token "+s},params:r};return y.a.post(C+"api/"+e+"/get-many",n,o).then((function(t){return t.data[e]}))}},{key:"getAssetNumber",value:function(){var e=this;y.a.get(C+"api/assets/asset-number",B(this.props.token)).then((function(t){e.setState({values:Re(e.state.values,{asset_number:t.data.asset_number})})}))}},{key:"componentDidMount",value:function(){this.setPowerPortInputState(),this.state.values.asset_number||this.props.initialValues||this.getAssetNumber(),this.state.values.rack&&this.getPowerPortAvailability(this.state.values.rack);var e=this.state.values;this.props.initialValues||(e=Re(e,{power_connections:{},mac_addresses:{}})),this.setState({values:e}),this.getValidAssets(this.state.currDatacenter),this.getRacks(this.state.currDatacenter)}},{key:"getClearedPowerSelections",value:function(){if(this.state.values.model&&this.state.values.model.num_power_ports&&parseInt(this.state.values.model.num_power_ports,10)>0&&this.state.values.power_connections){for(var e=parseInt(this.state.values.model.num_power_ports,10),t=this.state.values.power_connections,a=1;a<=e;a++)t[a]={};return t}return{}}},{key:"getValidDatacenters",value:function(){return this.props.datacenters.filter((function(e){return e!==Tt}))}},{key:"handleDatacenterSelect",value:function(e){var t=this.getClearedNetworkConnections(),a=this.getClearedPowerSelections(),n=Re(this.state.values,{rack:void 0,power_connections:a,network_connections:t});this.setState({currDatacenter:e,values:n}),this.getValidAssets(e),this.getRacks(e)}},{key:"handleRackSelect",value:function(e){var t=this.getClearedPowerSelections();this.setState({values:Re(this.state.values,{rack:e,power_connections:t})}),this.getPowerPortAvailability(e)}},{key:"handleNetworkConnectionAssetSelection",value:function(e,t){var a={source_port:e,destination_hostname:t,destination_port:null},n=!1,s=[];s=this.state.values.network_connections?(s=this.state.values.network_connections.slice()).map((function(a){return a.source_port===e?(n=!0,Re(a,{destination_hostname:t,destination_port:null})):a})):[],n||s.push(a),this.setState({values:Re(this.state.values,{network_connections:s})})}},{key:"getClearedNetworkConnections",value:function(){return this.state.values.network_connections?this.state.values.network_connections.map((function(e){return Re(e,{destination_hostname:null,destination_port:null})})):[]}},{key:"clearNetworkConnectionSelection",value:function(e){var t=[];t=this.state.values.network_connections?(t=this.state.values.network_connections.slice()).map((function(t){return t.source_port===e?Re(t,{destination_hostname:null,destination_port:null}):t})):[],this.setState({values:Re(this.state.values,{network_connections:t})})}},{key:"handleNetworkConnectionPortSelection",value:function(e,t){var a=[];a=this.state.values.network_connections?(a=this.state.values.network_connections.slice()).map((function(a){return a.source_port===e?Re(a,{destination_port:t}):a})):[],this.setState({values:Re(this.state.values,{network_connections:a})})}},{key:"getSelectedNetworkConnectionAsset",value:function(e){if(this.state.values.network_connections){var t=this.state.values.network_connections.find((function(t){return t.source_port===e}));if(t)return t.destination_hostname}}},{key:"getAssetObjectFromHostname",value:function(e){return this.state.assets.find((function(t){return t.hostname===e}))}},{key:"getPortsFromHostname",value:function(e){var t=this.getAssetObjectFromHostname(e);return F(t)&&t.model.network_ports?t.model.network_ports:[]}},{key:"getChangeWarningAlert",value:function(){return n.createElement(S.a,{className:_.a.DARK,cancelButtonText:"Cancel",confirmButtonText:"Change",intent:k.a.WARNING,icon:Ie.a.WARNING_SIGN,isOpen:this.state.isAlertOpen,onCancel:this.handleChangeDecline,onConfirm:this.handleChangeAccept},n.createElement("p",null,this.state.warningMessage))}},{key:"showChangeWarningAlert",value:function(e,t){this.setState({warningMessage:e,selectedValue:t,isAlertOpen:!0})}},{key:"render",value:function(){var e=this;0===this.state.models.length&&this.getModels(),0===this.state.users.length&&this.getUsers(),this.state.currDatacenter&&this.state.currDatacenter!==Tt&&!this.initialGetRacks&&this.getRacks(this.state.currDatacenter);var t=this.state.values;return n.createElement("div",{className:_.a.DARK+" login-container"},this.getChangeWarningAlert(),this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("form",{onSubmit:this.handleSubmit,className:"create-form "},n.createElement(S.f,null,n.createElement(S.k,{label:n.createElement("div",{className:"text-with-tooltip"}," ",A.asset_number," ",n.createElement(S.D,{className:"tooltip-icon",content:"If no asset number provided, will be autogenerated on creation"},n.createElement(S.m,{icon:Ie.a.INFO_SIGN}))," "),inline:!1},n.createElement(it,{placeholder:"asset_number",onChange:this.handleChange,value:t.asset_number,field:"asset_number"})),n.createElement(S.k,{label:A.hostname,inline:!1},n.createElement(it,{placeholder:"hostname",onChange:this.handleChange,value:t.hostname,field:"hostname"}))),n.createElement(S.f,null,n.createElement(S.k,{label:A.datacenter,inline:!1},n.createElement(Ae,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:this.getValidDatacenters(),onItemSelect:function(t){e.state.currDatacenter?e.showChangeWarningAlert("Are you sure you want to change datacenter? This will clear all datacenter related properties",t):e.handleDatacenterSelect(t)},itemRenderer:ke,itemPredicate:ue,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",text:this.state.currDatacenter&&this.state.currDatacenter.name?this.state.currDatacenter.name:"Select a Datacenter"})))),n.createElement(S.h,{isOpen:!Object(ht.isNullOrUndefined)(this.state.currDatacenter),keepChildrenMounted:!0},n.createElement(S.f,null,n.createElement(S.k,{label:A.rack,inline:!1},n.createElement(Ce,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:this.state.racks,onItemSelect:function(t){e.state.values.rack?e.showChangeWarningAlert("Are you sure you want to change rack? This will clear all rack related fields",t):e.handleRackSelect(t)},itemRenderer:be,itemPredicate:ce,noResults:this.gettingRacksInProgress?n.createElement("div",null,n.createElement(S.z,{intent:"primary",size:S.z.SIZE_SMALL}),n.createElement(S.p,{disabled:!0,text:"Getting all racks"})):n.createElement(S.p,{disabled:!0,text:"No available racks"})},n.createElement(S.c,{rightIcon:"caret-down",text:this.state.values.rack?this.state.values.rack.row_letter+ +this.state.values.rack.rack_num:"Select a rack"}))),n.createElement(S.k,{label:A.rack_position,inline:!1},n.createElement(it,{field:"rack_position",placeholder:"rack_position",value:t.rack_position,onChange:this.handleChange}))),n.createElement(S.f,null,n.createElement(S.k,{label:A.model,inline:!1},n.createElement(Ne,{className:"select",popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},disabled:!Object(ht.isNullOrUndefined)(this.initialState.model),items:this.state.models,onItemSelect:function(a){return e.setState({values:Re(t,{model:a})})},itemRenderer:_e,itemPredicate:pe,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",disabled:!Object(ht.isNullOrUndefined)(this.initialState.model),text:this.state.values.model?this.state.values.model.vendor+" "+this.state.values.model.model_number:"Select a model"})))),n.createElement(S.h,{isOpen:t.model&&t.model.network_ports&&0!==t.model.network_ports.length},t.model&&t.model.network_ports&&0!==t.model.network_ports.length?n.createElement(S.f,null,n.createElement(S.k,{label:A.network_ports,inline:!1},t.model.network_ports.map((function(a,s){return n.createElement("div",{className:"power-form-container"},n.createElement("i",{className:"section-title"},"Network Port: "+a),n.createElement("div",null,n.createElement("div",{className:"text-with-tooltip"},"Mac Address ",n.createElement(S.D,{className:"tooltip-icon",content:re},n.createElement(S.m,{icon:Ie.a.INFO_SIGN}))),n.createElement(S.n,{value:t.mac_addresses[a],type:"string",className:"network-name",onChange:function(n){var s=t.mac_addresses;s[a]=n.currentTarget.value,e.setState({values:Re(e.state.values,{mac_addresses:s})})}})),n.createElement(S.k,{label:"Add Network Connection",inline:!1},n.createElement(De,{className:"select",popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:e.state.assets,onItemSelect:function(t){e.handleNetworkConnectionAssetSelection(a,t.hostname)},itemRenderer:we,itemPredicate:me,noResults:e.gettingAssetsInProgress?n.createElement("div",null,n.createElement(S.z,{intent:"primary",size:S.z.SIZE_SMALL}),n.createElement(S.p,{disabled:!0,text:"Getting all available assets"})):n.createElement(S.p,{disabled:!0,text:"No available assets"})},n.createElement(S.c,{rightIcon:"caret-down",text:e.getSelectedNetworkConnectionAsset(a)?e.getSelectedNetworkConnectionAsset(a):"Select Asset"})),n.createElement(Oe,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},disabled:!e.getSelectedNetworkConnectionAsset(a),items:e.getSelectedNetworkConnectionAsset(a)?e.getPortsFromHostname(e.getSelectedNetworkConnectionAsset(a)):[],onItemSelect:function(t){e.handleNetworkConnectionPortSelection(a,t)},itemRenderer:ve,itemPredicate:le,noResults:e.gettingAssetsInProgress?n.createElement("div",null,n.createElement(S.z,{intent:"primary",size:S.z.SIZE_SMALL}),n.createElement(S.p,{disabled:!0,text:"Getting available network ports"})):n.createElement(S.p,{disabled:!0,text:"No available network ports"})},n.createElement(S.c,{disabled:!e.getSelectedNetworkConnectionAsset(a),rightIcon:"caret-down",text:e.getSelectedPort(a)?e.getSelectedPort(a):"Select Port"})),n.createElement(S.c,{icon:Ie.a.DELETE,minimal:!0,onClick:function(){e.clearNetworkConnectionSelection(a)}})))})))):null),n.createElement(S.h,{isOpen:this.state.values.model&&!Object(ht.isNullOrUndefined)(this.state.values.model.num_power_ports)},this.state.values.model&&this.state.values.model.num_power_ports&&parseInt(this.state.values.model.num_power_ports,10)>0?n.createElement(S.f,null,n.createElement(S.k,{label:A.power_connections,inline:!1},this.getPowerPortFields())):null)),n.createElement(S.f,null,n.createElement(S.k,{label:A.owner,inline:!1},n.createElement(Oe,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:this.state.users,onItemSelect:function(a){return e.setState({values:Re(t,{owner:a})})},itemRenderer:ve,itemPredicate:le,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",text:this.state.values.owner?this.state.values.owner:"Select an owner"}))),n.createElement(S.k,{label:A.comment,inline:!1},n.createElement("textarea",{className:_.a.INPUT,placeholder:"comment",value:t.comment,onChange:function(t){return e.handleChange({comment:t.currentTarget.value})}}))),n.createElement(S.c,{className:"login-button",type:"submit"},this.state.loading?"Submitting...":"Submit"),n.createElement("div",null),this.state.loading?n.createElement(S.z,{intent:"primary",size:S.z.SIZE_SMALL}):null))}}]),t}(n.Component),Mt=Object(E.b)((function(e){return{token:e.token,changePlan:e.changePlan}}))(Ft),Lt={log:function(){}},Ut=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).initialState=a.props.initialValues?JSON.parse(JSON.stringify(a.props.initialValues)):{},a.state={values:a.initialState,vendors:[],loading:!1,errors:[],networkPortsTemp:a.initialState.network_ports?a.initialState.network_ports:[]},a.headers={headers:{Authorization:"Token "+a.props.token}},a.handleSubmit=function(e){if(e.preventDefault(),a.state.values){a.setState({errors:[],loading:!0}),a.props.initialValues&&a.setState({values:Re(a.state.values,{id:a.props.initialValues.id})});var t=a.props.submitForm(a.state.values,a.headers);t&&(t.then((function(e){return a.setState({loading:!1})})),t.catch((function(e){xt()(".bp3-overlay-scroll-container").scrollTop(0);var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t,loading:!1})})))}},a.handleChange=function(e){var t=a.state.values.network_ports?a.state.values.network_ports:[];if(Lt.log("new change",e),e.num_network_ports){var n=e.num_network_ports;Lt.log(n,t);var s=t.length;for(!isNaN(n)&&n<0&&(n=0);t.length<n;)Lt.log(s,a.state.networkPortsTemp.length),s<a.state.networkPortsTemp.length?t.push(a.state.networkPortsTemp[s]):t.push(s+1),s++;for(;t.length>n;)t.pop()}else""===e.num_network_ports&&(Lt.log(t),a.setState({networkPortsTemp:t}),t=[]);a.setState({values:Re(a.state.values,Object(Te.a)({},e,{network_ports:t}))}),Lt.log(a.props.initialValues),Lt.log(a.state.values)},a.handleNetworkPortNameChange=function(e,t){var n=a.state.values.network_ports?a.state.values.network_ports:[];n[e]=t,a.setState({values:Re(a.state.values,Object(Te.a)({},n))})},a.selectText=function(e){return e.target.select()},a.componentDidMount=function(){xt()(".suggest").keydown((function(e){if(13===e.keyCode)return e.preventDefault(),!1}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getVendors",value:function(){var e=this;y.a.get(C+"api/models/vendors",this.headers).then((function(t){var a=t.data.vendors;e.setState({vendors:a})})).catch((function(e){Lt.log(e)}))}},{key:"render",value:function(){var e=this;0===this.state.vendors.length&&this.getVendors();var t=this.state.values;return Lt.log("vendor",this.state.values.vendor),n.createElement("div",{className:_.a.DARK+" login-container"},this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("form",{onSubmit:this.handleSubmit,className:"create-model-form bp3-form-group"},n.createElement(S.k,{className:"suggest",label:"Vendor (required)"},n.createElement(ye,{inputProps:{placeholder:"vendor"},popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},defaultSelectedItem:this.state.values.vendor,inputValueRenderer:function(t){return e.state.values.vendor},items:this.state.vendors,onItemSelect:function(a){Lt.log("item selected "),e.setState({values:Re(t,{vendor:a})})},onQueryChange:function(a){Lt.log("CHANGE",a),e.setState({values:Re(t,{vendor:a})})},itemRenderer:ve,itemPredicate:le,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})})),n.createElement(S.k,{label:"Model Number (required)",inline:!1},n.createElement(it,{placeholder:"model_number",onChange:this.handleChange,value:t.model_number,field:"model_number"})),n.createElement(S.k,{label:"Height (required)",inline:!1},n.createElement(it,{field:"height",placeholder:"height",value:t.height,onChange:this.handleChange})),n.createElement(S.k,{label:"Display Color"},n.createElement(it,{field:"display_color",type:"color",value:t.display_color?t.display_color:"#394B59",onChange:this.handleChange})),n.createElement(S.k,{label:"Number of Network Ports ",inline:!1},n.createElement(it,{field:"num_network_ports",value:t.num_network_ports,onChange:this.handleChange}),t.network_ports&&0!==t.network_ports.length?n.createElement("table",{className:"port-table"},n.createElement("thead",null,n.createElement("th",null,"Port Name(s) ")),n.createElement("tbody",null,t.network_ports.map((function(t,a){return n.createElement("tr",null,n.createElement("td",null,n.createElement(S.n,{onClick:e.selectText,value:t,type:"string",className:"network-name",onChange:function(t){return e.handleNetworkPortNameChange(a,t.currentTarget.value)}})))})))):null),n.createElement(S.k,{label:"# Power Ports",inline:!1},n.createElement(it,{field:"num_power_ports",placeholder:"num_power_ports",value:t.num_power_ports,onChange:this.handleChange})),n.createElement(S.k,{label:"CPU",inline:!1},n.createElement(it,{field:"cpu",placeholder:"cpu",value:t.cpu,onChange:this.handleChange})),n.createElement(S.k,{label:"Memory(GB)",inline:!1},n.createElement(it,{field:"memory_gb",placeholder:"memory_gb",value:t.memory_gb,onChange:this.handleChange})),n.createElement(S.k,{label:"Storage",inline:!1},n.createElement(it,{field:"storage",placeholder:"storage",value:t.storage,onChange:this.handleChange})),n.createElement(S.k,{label:"Comment",inline:!1},n.createElement("textarea",{className:_.a.INPUT,placeholder:"comment",value:t.comment,onChange:function(t){return e.handleChange({comment:t.currentTarget.value})}})),n.createElement(S.c,{className:"login-button",type:"submit"},this.state.loading?"Submitting...":"Submit"),n.createElement("div",null),this.state.loading?n.createElement(S.z,{intent:"primary",size:S.z.SIZE_SMALL}):null))}}]),t}(n.Component),Gt=Object(E.b)((function(e){return{token:e.token}}))(Ut),Bt={log:function(){}},Ht=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).initialState=a.props.initialValues?a.props.initialValues:{},a.state={values:a.initialState,errors:[]},a.headers={headers:{Authorization:"Token "+a.props.token}},a.handleSubmit=function(e){if(a.setState({errors:[]}),e.preventDefault(),Bt.log(a.state),a.state.values){a.props.initialValues&&(Bt.log(a.props.initialValues),a.setState({values:Re(a.state.values,{id:a.props.initialValues.id})}));var t=a.props.submitForm(a.state.values,a.headers);t&&t.catch((function(e){Bt.log(e.response.data.failure_message);var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t})}))}},a.handleChange=function(e){a.setState({values:Re(a.state.values,Object(Te.a)({},e))})},a.selectText=function(e){return e.target.select()},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state.values;return n.createElement("div",{className:_.a.DARK+" login-container"},this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("form",{onSubmit:this.handleSubmit,className:"create-form bp3-form-group"},n.createElement(S.k,{label:"Name*",inline:!1},n.createElement(it,{field:"name",placeholder:"name",value:e.name,onChange:this.handleChange})),n.createElement(S.k,{label:"Abbreviation* (up to 6 characters)",inline:!1},n.createElement(it,{placeholder:"abbreviation",onChange:this.handleChange,value:e.abbreviation,field:"abbreviation"})),n.createElement(S.c,{className:"login-button",type:"submit"},"Submit")))}}]),t}(n.Component),Vt=Object(E.b)((function(e){return{token:e.token}}))(Ht),Kt=a(734),zt=(a(243),Kt.a.Item),Wt={log:function(){}},qt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={confirmDirty:!1,errors:[]},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,t){Wt.log("calling authSignup");var n={username:t.userName,email:t.email,first_name:t.firstName,last_name:t.lastName,password1:t.password,password2:t.confirm};if(!e){var s=a.props.authSignup(n,B(a.props.token));s&&s.catch((function(e){Wt.log(e);var t=[];Object.entries(e.response.data).forEach((function(e){var a=Object(je.a)(e,2),n=a[0],s=a[1];t.push(n+": "+s)})),a.setState({errors:t}),Wt.log(t)}))}}))},a.handleConfirmBlur=function(e){var t=e.target.value;a.setState({confirmDirty:a.state.confirmDirty||!!t})},a.compareToFirstPassword=function(e,t,n){var s=a.props.form;t&&t!==s.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},a.validateToNextPassword=function(e,t,n){var s=a.props.form;t&&a.state.confirmDirty&&s.validateFields(["confirm"],{force:!0}),n()},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:_.a.DARK+" login-container"},this.state.errors.map((function(e){return s.a.createElement(S.e,{intent:k.a.DANGER},e)})),s.a.createElement(Kt.a,{onSubmit:this.handleSubmit,className:"login-form .bp3-form-group"},s.a.createElement("h2",null,"Add a new user"),s.a.createElement(zt,{label:"Username*"},e("userName",{rules:[{required:!0,message:"Please input your username!"}]})(s.a.createElement(S.n,{placeholder:"Username"}))),s.a.createElement(zt,{label:"First Name*"},e("firstName",{rules:[{required:!0,message:"Please input your first name!"}]})(s.a.createElement(S.n,{placeholder:"first name"}))),s.a.createElement(zt,{label:"Last Name*"},e("lastName",{rules:[{required:!0,message:"Please input your last name!"}]})(s.a.createElement(S.n,{placeholder:"last name"}))),s.a.createElement(zt,{label:"Email*"},e("email",{rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]})(s.a.createElement(S.n,{placeholder:"email"}))),s.a.createElement(zt,{label:"Password*"},e("password",{rules:[{required:!0,message:"Please input your password!"},{validator:this.validateToNextPassword}]})(s.a.createElement(S.n,{type:"password",placeholder:"Password"}))),s.a.createElement(zt,{label:"Password Confirmation*"},e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(s.a.createElement(S.n,{type:"password",placeholder:"Password",onBlur:this.handleConfirmBlur}))),s.a.createElement(zt,null,s.a.createElement(S.c,{className:"login-button",type:"submit"},"Add"))))}}]),t}(s.a.Component),Yt=Kt.a.create()(Object(v.f)(qt));var Jt,Zt=(Jt=Object(E.b)((function(e){return{loading:e.loading,error:e.error,token:e.token}}))(Yt),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return s.a.createElement(Jt,this.props)}}]),t}(s.a.Component)),Xt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).initialState=a.props.initialValues?JSON.parse(JSON.stringify(a.props.initialValues)):{},a.state={values:a.initialState,errors:[]},a.handleChange=function(e){a.setState({values:Re(a.state.values,Object(Te.a)({},e))})},a.handleSubmit=function(e){if(e.preventDefault(),a.state.values){a.setState({errors:[]}),a.props.initialValues&&a.setState({values:Re(a.state.values,{id:a.props.initialValues.id})});var t=a.props.submitForm(a.state.values,B(a.props.token));t&&t.catch((function(e){var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t})}))}},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:_.a.DARK+" login-container"},this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("form",{onSubmit:this.handleSubmit,className:"create-form bp3-form-group"},n.createElement(S.k,{label:"Change Plan Name"},n.createElement(it,{field:"name",value:this.state.values.name,onChange:this.handleChange})),n.createElement(S.c,{className:"login-button",type:"submit"},"Submit")))}}]),t}(n.Component),$t=Object(E.b)((function(e){return{token:e.token}}))(Xt),Qt=a(102),ea={log:function(){}},ta=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.state={initialValues:{model_management:!1,asset_management:!1,power_control:!1,audit_read:!1,admin:!1,datacenter_permissions:[]},errors:[],permissions:{model_management:!1,asset_management:!1,power_control:!1,audit_read:!1,admin:!1,datacenter_permissions:[""]},datacenters:[],datacenter_selection:"Global",loading:!0,show_asset_options:!1},a.handleSubmit=function(e){if(!a.state.show_asset_options){var t=a.state.permissions;t.asset_management=!1,t.datacenter_permissions=[],a.setState({permissions:t})}a.setState({errors:[]}),e.preventDefault(),ea.log("submitting"),ea.log(a.state);var n={id:a.props.userId,model_management:a.state.permissions.model_management,asset_management:a.state.permissions.asset_management,power_control:a.state.permissions.power_control,audit_read:a.state.permissions.audit_read,admin:a.state.permissions.admin,datacenter_permissions:a.state.permissions.datacenter_permissions};st(n,B(a.props.token)).then(a.props.submitForm()).catch((function(e){ea.log(e.response.data.failure_message);var t=a.state.errors;t.push(e.response.data.failure_message),a.setState({errors:t})}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"componentDidMount",value:function(){var e=this;this.getDatacenters().then((function(t){var a=t.datacenters;a.sort(e.compare),e.setState({datacenters:a}),e.getUserPermissions(e.props.userId)})).catch((function(t){e.addToast({message:t.response.data.failure_message,intent:k.a.DANGER})}))}},{key:"render",value:function(){var e=this;return ea.log(this.state),n.createElement("div",null,n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),this.state.loading?n.createElement(S.z,null):n.createElement("div",{className:_.a.DARK+" login-container"},this.state.errors.map((function(e){return n.createElement(S.e,{intent:k.a.DANGER},e)})),n.createElement("h2",null,"Select permissions to grant this user"),n.createElement("form",{onSubmit:this.handleSubmit,className:"create-form bp3-form-group"},n.createElement(S.k,{inline:!0},n.createElement(S.g,{label:"Administrator",alignIndicator:Qt.a.LEFT,checked:this.state.permissions.admin,onChange:function(){var t;t={model_management:e.state.permissions.model_management,asset_management:e.state.permissions.asset_management,power_control:e.state.permissions.power_control,audit_read:e.state.permissions.audit_read,admin:!e.state.permissions.admin,datacenter_permissions:e.state.permissions.datacenter_permissions},e.setState({permissions:t,show_asset_options:!1})}})),n.createElement(S.k,{inline:!0},n.createElement(S.g,{label:"Model Management",alignIndicator:Qt.a.LEFT,checked:!!this.state.permissions.admin||this.state.permissions.model_management,disabled:this.state.permissions.admin,onChange:function(){e.setState({permissions:e.updateBooleanPermissions("model_management")})}})),n.createElement(S.k,{inline:!0},n.createElement(S.g,{label:"Power Control",alignIndicator:Qt.a.LEFT,checked:!!this.state.permissions.admin||this.state.permissions.power_control,disabled:this.state.permissions.admin,onChange:function(){e.setState({permissions:e.updateBooleanPermissions("power_control")})}})),n.createElement(S.k,{inline:!0},n.createElement(S.g,{label:"Audit Log",checked:!!this.state.permissions.admin||this.state.permissions.audit_read,alignIndicator:Qt.a.LEFT,disabled:this.state.permissions.admin,onChange:function(){e.setState({permissions:e.updateBooleanPermissions("audit_read")})}})),n.createElement(S.k,{inline:!0},n.createElement(S.g,{label:"Asset Management",checked:!!this.state.permissions.admin||this.state.show_asset_options,alignIndicator:Qt.a.LEFT,disabled:this.state.permissions.admin,onChange:function(){e.setState({show_asset_options:!e.state.show_asset_options})}})),this.state.show_asset_options?n.createElement(S.y,{inline:!0,label:"Asset permissions",onChange:function(){ea.log("changing datacenter"),ea.log(e.state);var t=e.state.permissions;if("Global"===e.state.datacenter_selection)t.datacenter_permissions=e.state.initialValues.datacenter_permissions,t.asset_management=!1,e.setState({datacenter_selection:"Per Datacenter",permissions:t});else{var a;a=[];for(var n=0;n<e.state.datacenters.length;n++)a.push(e.state.datacenters[n].id);t.datacenter_permissions=a,t.asset_management=e.state.show_asset_options,e.setState({datacenter_selection:"Global",permissions:t})}},selectedValue:this.state.datacenter_selection},n.createElement(S.x,{label:"Global",value:"Global"}),n.createElement(S.x,{label:"Per Datacenter",value:"Per Datacenter"})):null,this.state.show_asset_options&&"Per Datacenter"===this.state.datacenter_selection?this.renderDatacenterChecks():null,n.createElement(S.c,{className:"login-button",type:"submit"},"Submit"))))}},{key:"compare",value:function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}},{key:"renderDatacenterChecks",value:function(){var e;e=[];for(var t=0;t<this.state.datacenters.length;t++)e.push(this.renderDatacenter(this.state.datacenters[t]));return e}},{key:"renderDatacenter",value:function(e){var t=this;return ea.log(this.state.permissions.datacenter_permissions.includes(e.id)),n.createElement(S.k,{key:e.name,inline:!0},n.createElement(S.g,{label:e.name,alignIndicator:Qt.a.LEFT,checked:this.state.permissions.datacenter_permissions.includes(e.id),onChange:function(){ea.log(e);var a=t.state.permissions;if(t.state.permissions.datacenter_permissions.includes(e.id)){var n=t.state.permissions.datacenter_permissions.indexOf(e.id);a.datacenter_permissions.splice(n,1)}else a.datacenter_permissions.push(e.id);t.setState({permissions:a})}}))}},{key:"getDatacenters",value:function(){var e=this;return y.a.post(C+"api/datacenters/get-many",{sort_by:[],filters:[]},B(this.props.token)).then((function(e){return e.data})).catch((function(t){e.addToast({message:t.response.data.failure_message,intent:k.a.DANGER})}))}},{key:"getUserPermissions",value:function(e){var t=this,a={id:e};y.a.post(C+"api/users/permissions/get",a,B(this.props.token)).then((function(e){ea.log(e.data),t.setState({initialValues:e.data,permissions:e.data}),e.data.asset_management?t.setState({datacenter_selection:"Global"}):t.setState({datacenter_selection:"Per Datacenter"}),t.setState({loading:!1,show_asset_options:t.state.permissions.asset_management||t.state.permissions.datacenter_permissions.length>0})})).catch((function(e){t.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))}},{key:"updateBooleanPermissions",value:function(e){var t;return(t=this.state.permissions)[e]=!t[e],t}}]),t}(n.Component),aa=Object(E.b)((function(e){return{token:e.token}}))(ta),na=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return n.createElement(S.i,{className:_.a.DARK,usePortal:!0,enforceFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,isOpen:this.props.isOpen,onClose:this.props.handleClose,title:this.props.type+" "+this.props.elementName.slice(0,-1)},this.props.elementName===l.MODEL?n.createElement(Gt,{type:K.CREATE,submitForm:this.props.submitForm,initialValues:j(this.props.initialValues)?this.props.initialValues:void 0}):null,this.props.elementName===l.ASSET?n.createElement(Mt,{datacenters:this.props.datacenters?this.props.datacenters:[],currDatacenter:this.props.currDatacenter?this.props.currDatacenter:Tt,isOpen:this.props.isOpen,type:K.CREATE,submitForm:this.props.submitForm,initialValues:F(this.props.initialValues)?this.props.initialValues:void 0}):null,this.props.elementName===l.RACK?n.createElement(Ct,{loading:this.props.loading,submitForm:this.props.submitForm}):null,this.props.elementName!==l.USER||this.props.userId?null:n.createElement(Zt,{authSignup:this.props.submitForm}),this.props.elementName===l.DATACENTER?n.createElement(Vt,{type:K.CREATE,submitForm:this.props.submitForm,initialValues:I(this.props.initialValues)?this.props.initialValues:void 0}):null,this.props.elementName===l.CHANGEPLANS?n.createElement($t,{submitForm:this.props.submitForm,initialValues:U(this.props.initialValues)?this.props.initialValues:void 0}):null,this.props.elementName===l.USER&&this.props.userId?n.createElement(aa,{userId:this.props.userId,submitForm:function(){e.props.submitForm({},{})}}):null)}}]),t}(n.Component),sa=(a(569),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).setFieldNamesFromData=function(){var e=[];return Object.keys(a.props.data).forEach((function(t){"id"!==t&&"power_connections"!==t&&"mac_addresses"!==t&&"network_connections"!==t&&"network_graph"!==t&&"decommissioned_id"!==t&&"decommissioning_user"!==t&&"time_decommissioned"!==t&&e.push(t)})),e},a.state={isDeleteOpen:!1,fields:a.setFieldNamesFromData()},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"renderData",value:function(e,t){var a=this;return e.map((function(e){var s;if("display_color"===e)s=n.createElement("p",{className:"color",style:{backgroundColor:t[e]}},t[e]);else if("network_ports"===e){if(t[e]){var r=t[e];s=n.createElement("p",null,r.toString())}}else if("model"===e){var o=t.decommissioning_user;s=n.createElement("p",{className:o?void 0:"model-link",onClick:o?void 0:function(){return a.props.history.push(i.MODELS+"/"+t[e].id)}},t[e].vendor+" "+t[e].model_number)}else{if("rack"===e)return[n.createElement("tr",null,n.createElement("td",{key:e},n.createElement("p",{className:"label"},D[e],":")),n.createElement("td",{style:H(t)}," ",n.createElement("p",null,t[e].row_letter+""+t[e].rack_num))),n.createElement("tr",null,n.createElement("td",{key:"datacenter"},n.createElement("p",{className:"label"},D.rack__datacenter__name,":")),n.createElement("td",{style:H(t)}," ",n.createElement("p",null,t[e].datacenter.name)))];"comment"===e?s=n.createElement("p",{className:"comment"},t[e]):R(t[e])||(s=n.createElement("p",null,t[e]))}return F(a.props.data)?D[e]?n.createElement("tr",null,n.createElement("td",{key:e},n.createElement("p",{className:"label"},D[e],":")),n.createElement("td",{style:H(t)},s)):null:j(a.props.data)?n.createElement("tr",null,n.createElement("td",{key:e},n.createElement("p",{className:"label"},T[e],":")),n.createElement("td",null,s)):n.createElement("tr",null,n.createElement("td",{key:e},n.createElement("p",{className:"label"},e,":")),n.createElement("td",null,s))}))}},{key:"render",value:function(){0===this.state.fields.length&&0!==Object.keys(this.props.data).length&&this.setState({fields:this.setFieldNamesFromData()});var e=Math.ceil(this.state.fields.length/4);return n.createElement("div",{className:_.a.DARK+" propsview"},n.createElement("h3",null,"Properties"),0!==Object.keys(this.props.data).length?n.createElement("div",{className:"propsdetail"},n.createElement("div",{className:"props-column"},n.createElement("table",{className:"bp3-html-table"},this.renderData(this.state.fields.slice(0,e),this.props.data))),n.createElement("div",{className:"props-column"},n.createElement("table",{className:"bp3-html-table"},this.renderData(this.state.fields.slice(e,2*e),this.props.data))),n.createElement("div",{className:"props-column"},n.createElement("table",{className:"bp3-html-table"},this.renderData(this.state.fields.slice(2*e,3*e),this.props.data))),n.createElement("div",{className:"props-column"},n.createElement("table",{className:"bp3-html-table"},this.renderData(this.state.fields.slice(3*e),this.props.data)))):null)}}]),t}(n.PureComponent)),ra=Object(E.b)((function(e){return{changePlan:e.changePlan}}))(Object(v.f)(sa)),oa=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).setFieldNamesFromData=function(){var e=[];return Object.keys(a.props.data).forEach((function(t){"decommissioning_user"!==t&&"time_decommissioned"!==t||e.push(t)})),e},a.state={isDeleteOpen:!1,fields:a.setFieldNamesFromData()},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"renderData",value:function(e,t){return e.map((function(e){var a;return a=n.createElement("p",null,t[e]),n.createElement("tr",null,n.createElement("td",{key:e},n.createElement("p",{className:"label"},P[e],":")),n.createElement("td",null,a))}))}},{key:"render",value:function(){return n.createElement("div",{className:_.a.DARK+" propsview"},n.createElement("h3",null,"Decommissioned"),n.createElement("div",{className:"propsdetail"},n.createElement("div",{className:"props-column"},n.createElement("table",{className:"bp3-html-table"},this.renderData(this.state.fields,this.props.data)))))}}]),t}(n.PureComponent),ia=Object(v.f)(oa),la=(a(570),a(329)),ca=a.n(la),ua=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).options={layout:{},edges:{color:"#5C7080",arrows:{to:!1,from:!1}},nodes:{color:{background:"#202B33",border:"#202B33",highlight:{background:"#182026",border:"#30404D"}},font:{color:"white"},physics:!1},interaction:{hover:!a.props.isDecommissioned,zoomView:!1}},a.onClickNode=function(e){var t=e.nodes;t.length>0&&!a.props.isDecommissioned&&a.props.onClickNode(t[0])},a.events={select:a.onClickNode},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"graph-container"},this.props.networkGraph?s.a.createElement(ca.a,{graph:this.props.networkGraph,options:this.options,events:this.events}):null)}}]),t}(s.a.Component),da=Object(v.f)(ua),pa=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={asset:{},isFormOpen:!1,isDeleteOpen:!1,isDecommissionOpen:!1,isAlertOpen:!1,datacenters:[],powerShouldUpdate:!1},a.successfullyLoadedData=!1,a.updateAsset=function(e,t){var n;return n=a.props.match.params,Xe(e,t,a.props.changePlan).then((function(e){e.data.warning_message?a.addWarnToast("Modifed asset. "+e.data.warning_message):a.addSuccessToast(e.data.success_message),a.getData(n.rid,a.props.changePlan),a.handleFormClose()}))},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.addSuccessToast=function(e){a.addToast({message:e,intent:k.a.PRIMARY})},a.addWarnToast=function(e){a.addToast({message:e,intent:k.a.WARNING,action:{onClick:function(){return a.setState({isFormOpen:!0})},text:"Edit values"}})},a.addErrorToast=function(e){a.addToast({message:e,intent:k.a.DANGER})},a.updateAssetData=function(e){a.getData(e,a.props.changePlan)},a.updateAssetDataCP=function(e,t){a.getData(e,t)},a.getDatacenters=function(){var e=B(a.props.token);y.a.post(C+"api/datacenters/get-many",{},e).then((function(e){var t=e.data.datacenters;t.push(Tt),a.setState({datacenters:t})})).catch((function(e){}))},a.getAssetIdFromHostname=function(e){var t=a.state.asset.network_graph.nodes.find((function(t){return t.label===e}));if(t)return t.id},a.redirectToAsset=function(e){a.props.history.push(i.ASSETS+"/"+e),a.updateAssetData(e)},a.handleFormOpen=function(){a.setState({isFormOpen:!0})},a.handleFormSubmit=function(){a.setState({isFormOpen:!1})},a.handleFormClose=function(){return a.setState({isFormOpen:!1})},a.handleDeleteCancel=function(){return a.setState({isDeleteOpen:!1})},a.handleDeleteOpen=function(){return a.setState({isDeleteOpen:!0})},a.handleDelete=function(){Ze(a.state.asset,B(a.props.token)).then((function(e){a.setState({isDeleteOpen:!1}),a.addSuccessToast(e.data.success_message),a.props.history.push(i.DASHBOARD)})).catch((function(e){a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))},a.handleDecommissionCancel=function(){return a.setState({isDecommissionOpen:!1})},a.handleDecommissionOpen=function(){return a.setState({isDecommissionOpen:!0})},a.handleDecommission=function(){$e(a.state.asset,B(a.props.token),a.props.changePlan).then((function(e){var t;a.setState({isDecommissionOpen:!1}),a.addSuccessToast("Successfully Decommissioned Asset"),t=a.props.match.params,a.updateAssetData(t.rid)})).catch((function(e){a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER})}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"getData",value:function(e,t){var a=this,n={};t&&(n.change_plan=t.id);var s={headers:{Authorization:"Token "+this.props.token},params:n};y.a.get(C+"api/assets/"+e,s).then((function(e){return e.data})).then((function(e){a.setState({asset:e,powerShouldUpdate:!0})})).catch((function(e){a.setState({asset:{}}),a.addErrorToast(e.response.data.failure_message)}))}},{key:"componentWillReceiveProps",value:function(e){var t;e.changePlan!==this.props.changePlan&&(t=this.props.match.params,this.updateAssetDataCP(t.rid,e.changePlan))}},{key:"getNetworkConnectionForPort",value:function(e){return this.state.asset.network_connections.find((function(t){return t.source_port===e}))}},{key:"detectConflict",value:function(e){return e.is_conflict||!Object(ht.isNullOrUndefined)(e.asset_conflict_location)||!Object(ht.isNullOrUndefined)(e.asset_conflict_asset_name)||!Object(ht.isNullOrUndefined)(e.asset_conflict_hostname)}},{key:"render",value:function(){var e,t=this;!this.successfullyLoadedData&&this.props.token&&(e=this.props.match.params,this.updateAssetData(e.rid),this.successfullyLoadedData=!0);return 0===this.state.datacenters.length&&this.getDatacenters(),n.createElement("div",{className:_.a.DARK+" asset-view"},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),this.state.asset.decommissioning_user?null:n.createElement("div",{className:"detail-buttons-wrapper"},n.createElement("div",{className:"detail-buttons"},n.createElement(S.b,{intent:"primary",icon:"edit",text:"Edit",minimal:!0,onClick:function(){return t.handleFormOpen()},disabled:G(this.state.asset)&&this.state.asset.is_decommissioned||!(this.props.permissionState.admin||this.props.permissionState.asset_management||this.state.asset&&this.state.asset.rack&&this.props.permissionState.datacenter_permissions.includes(+this.state.asset.rack.datacenter.id))}),n.createElement(na,{datacenters:this.state.datacenters,isOpen:this.state.isFormOpen,initialValues:this.state.asset,type:K.MODIFY,elementName:l.ASSET,handleClose:this.handleFormClose,submitForm:this.updateAsset}),n.createElement(S.b,{minimal:!0,intent:"danger",icon:"remove",text:"Decommission",onClick:this.handleDecommissionOpen,disabled:G(this.state.asset)&&this.state.asset.is_decommissioned||!(this.props.permissionState.admin||this.props.permissionState.asset_management||this.state.asset&&this.state.asset.rack&&this.props.permissionState.datacenter_permissions.includes(+this.state.asset.rack.datacenter.id))}),n.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Decommission",intent:"danger",isOpen:this.state.isDecommissionOpen,onCancel:this.handleDecommissionCancel,onConfirm:this.handleDecommission},n.createElement("p",null,"Are you sure you want to decommission this asset? This action cannot be undone.")),n.createElement(S.b,{minimal:!0,intent:"danger",icon:"trash",text:"Delete",onClick:this.handleDeleteOpen,disabled:!Object(ht.isNullOrUndefined)(this.props.changePlan)||!(this.props.permissionState.admin||this.props.permissionState.asset_management||this.state.asset&&this.state.asset.rack&&this.props.permissionState.datacenter_permissions.includes(+this.state.asset.rack.datacenter.id))}),n.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Delete",intent:"danger",icon:"warning-sign",isOpen:this.state.isDeleteOpen,onCancel:this.handleDeleteCancel,onConfirm:this.handleDelete},n.createElement("p",null,"Are you sure you want to ",n.createElement("b",null,"delete")," this asset? Unless it was created in error, consider ",n.createElement("b",null,"decommissioning")," instead.")))),this.state.asset.decommissioning_user?n.createElement(ia,{data:this.state.asset}):null,G(this.state.asset)&&this.state.asset.is_decommissioned?n.createElement(S.e,{className:"propsview",intent:k.a.WARNING,title:"This asset has been marked as decommissioned on this change plan. "},"This asset will actually become decommissioned at the time of change plan execution, but no more modifications can be made to this asset."):null,G(this.state.asset)&&this.detectConflict(this.state.asset)?n.createElement(S.e,{className:"propsview",intent:k.a.DANGER,title:"This asset has conflicts "},"Please go to change plan detail view for more details"):null,n.createElement(ra,{data:this.state.asset}),n.createElement("div",{className:"propsview"},n.createElement("h3",null,"Network Connections"),this.state.asset.model&&this.state.asset.model.network_ports&&0!==this.state.asset.model.network_ports.length?n.createElement("div",{className:"network-connections"},n.createElement("table",{className:"bp3-html-table bp3-html-table-bordered bp3-html-table-striped"},n.createElement("tr",null,n.createElement("th",null,"Network Port"),n.createElement("th",null,"Mac Address"),n.createElement("th",null,"Destination Asset"),n.createElement("th",null,"Destination Port")),n.createElement("tbody",null,this.state.asset.model.network_ports.map((function(e){var a=t.getNetworkConnectionForPort(e);return n.createElement("tr",null," ",n.createElement("td",{style:H(t.state.asset)},e),n.createElement("td",{style:H(t.state.asset)},t.state.asset.mac_addresses?t.state.asset.mac_addresses[e]:null)," ",a?[n.createElement("td",{style:H(t.state.asset),className:t.state.asset.decommissioning_user?void 0:"asset-link",onClick:t.state.asset.decommissioning_user?void 0:function(e){var n=t.getAssetIdFromHostname(a.destination_hostname);n&&t.redirectToAsset(n)}},a.destination_hostname),n.createElement("td",{style:H(t.state.asset)},a.destination_port)]:[n.createElement("td",null),n.createElement("td",null)])})))),n.createElement(da,{networkGraph:this.state.asset.network_graph,onClickNode:this.redirectToAsset,isDecommissioned:void 0!==this.state.asset.decommissioning_user})):null),0!==Object.keys(this.state.asset).length?this.renderPower():null)}},{key:"renderPower",value:function(){var e=this;return n.createElement(mt,Object.assign({},this.props,{asset:this.state.asset,shouldUpdate:this.state.powerShouldUpdate,updated:function(){e.setState({powerShouldUpdate:!1})},assetIsDecommissioned:void 0!==this.state.asset.decommissioning_user}))}}]),t}(n.PureComponent),ma=Object(v.f)(Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,changePlan:e.changePlan,permissionState:e.permissionState}}))(pa)),ha=a(25),fa=a.n(ha);function ga(e,t,a){var n,s;return fa.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={},a&&(n.change_plan=a.id),s={headers:{Authorization:"Token "+t},params:n},r.next=5,fa.a.awrap(y.a.get(C+"api/models/"+e,s).then((function(e){return e.data})));case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}))}var Ea=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={assets:[],model:{},isFormOpen:!1,isDeleteOpen:!1},a.updateModel=function(e,t){return Ye(e,t).then((function(e){ga(a.props.match.params.rid,a.props.token,a.props.changePlan).then((function(e){a.setState({model:e.model,assets:e.assets})})),a.handleFormClose()}))},a.handleDeleteOpen=function(){return a.setState({isDeleteOpen:!0})},a.handleDeleteCancel=function(){return a.setState({isDeleteOpen:!1})},a.handleFormOpen=function(){a.setState({isFormOpen:!0})},a.handleFormSubmit=function(){a.setState({isFormOpen:!1})},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.handleFormClose=function(){return a.setState({isFormOpen:!1})},a.handleDelete=function(){Je(a.state.model,B(a.props.token)).then((function(e){a.setState({isDeleteOpen:!1}),a.addToast({message:"Succesfully Deleted Model",intent:k.a.PRIMARY}),a.props.history.push(i.DASHBOARD)})).catch((function(e){a.addToast({message:e.response.data.failure_message,intent:k.a.DANGER}),a.handleDeleteCancel()}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.changePlan!==this.props.changePlan&&ga(this.props.match.params.rid,this.props.token,e.changePlan).then((function(e){t.setState({model:e.model,assets:e.assets})}))}},{key:"render",value:function(){var e,t=this;return e=this.props.match.params,0===Object.keys(this.state.model).length&&ga(e.rid,this.props.token,this.props.changePlan).then((function(e){t.setState({model:e.model,assets:e.assets})})),n.createElement("div",{className:_.a.DARK+" model-view"},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),n.createElement("div",{className:"detail-buttons-wrapper"},n.createElement("div",{className:"detail-buttons"},n.createElement(S.b,{className:"button-add",intent:"primary",icon:"edit",text:"Edit",minimal:!0,onClick:function(){return t.handleFormOpen()},disabled:!(this.props.permissionState.admin||this.props.permissionState.model_management)}),n.createElement(na,{isOpen:this.state.isFormOpen,initialValues:this.state.model,type:K.MODIFY,elementName:l.MODEL,handleClose:this.handleFormClose,submitForm:this.updateModel}),n.createElement(S.b,{className:"button-add",intent:"danger",icon:"trash",text:"Delete",minimal:!0,onClick:this.handleDeleteOpen,disabled:!(this.props.permissionState.admin||this.props.permissionState.model_management)}),n.createElement(S.a,{className:_.a.DARK,cancelButtonText:"Cancel",confirmButtonText:"Delete",intent:"danger",isOpen:this.state.isDeleteOpen,onCancel:this.handleDeleteCancel,onConfirm:this.handleDelete},n.createElement("p",null,"Are you sure you want to delete?")))),n.createElement(ra,{data:this.state.model}),n.createElement("div",{className:"propsview"},n.createElement("h3",null,"Assets"),n.createElement(gt,{type:l.ASSET,data:this.state.assets,disableFiltering:!0,disableSorting:!0,isDecommissioned:!1})))}}]),t}(n.PureComponent),va=Object(v.f)(Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin,changePlan:e.changePlan,permissionState:e.permissionState}}))(Ea)),ba=a(207),ka=a.n(ba),_a=(a(709),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){window.moveBy(0,1e3),window.print()}},{key:"render",value:function(){var e;return e=localStorage.getItem("barcodes").split(","),n.createElement("div",{className:_.a.DARK},n.createElement("table",null,n.createElement("tbody",null,this.renderBarcodes(e))))}},{key:"renderBarcodes",value:function(e){var t,a,s=0;t=[],a=[];for(var r=0;r<e.length;r++)++s<5?t.push(n.createElement("td",{className:"barcode-container"},n.createElement(ka.a,{value:e[r],text:"Hyposoft "+e[r],"text-align":"left",height:26,fontSize:9,textMargin:1,width:2.25,margin:6}))):(s=1,a.push(n.createElement("tr",{className:"barcode-row"},t)),(t=[]).push(n.createElement("td",{className:"barcode-container"},n.createElement(ka.a,{value:e[r],text:"Hyposoft "+e[r],"text-align":"left",height:26,fontSize:9,textMargin:1,width:2.25,margin:6}))));return t.length>0&&a.push(n.createElement("tr",{className:"barcode-row"},t)),a}}]),t}(n.PureComponent)),Sa=Object(E.b)((function(e){return{token:e.token,isAdmin:e.admin}}))(Object(v.f)(_a)),wa=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"isExistingPath",value:function(){var e=this;return!!new RegExp("^/dashboard/(assets|models|datacenters|racks|bulk-upload|change-plans)|^/dashboard$").exec(this.props.location.pathname)||Object.values(i).some((function(t){return t===e.props.location.pathname}))}},{key:"render",value:function(){return this.isExistingPath()?null:Oa}}]),t}(n.Component),Oa=n.createElement(S.e,{intent:k.a.WARNING},n.createElement("h4",{className:_.a.DARK},"The page that you are looking for does not exist!")),ya=function(){return n.createElement(S.e,{intent:k.a.WARNING},n.createElement("h4",{className:_.a.DARK},"Please log in to see this page"))},Na=function(){return n.createElement(S.e,{intent:k.a.WARNING},n.createElement("h4",{className:_.a.DARK},"You are not authorized to view this page."))},Ca=wa,Aa=a(82),Da=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={prompt:"Choose file..."},a.handleChange=a.handleChange.bind(Object(Aa.a)(a)),a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"handleChange",value:function(e){var t=e.files[0].name.match(/.*\.(\w+)/),a=t[t.length-1];"csv"!==a?alert("WARNING: file must be .csv. You selected a file of type: ."+a):(this.setState({prompt:e.files[0].name}),this.props.callback(e.files[0]))}},{key:"render",value:function(){var e=this;return n.createElement("label",{className:"bp3-file-input"},n.createElement("input",{type:"file",onChange:function(t){e.handleChange(t.target)}}),n.createElement("span",{className:"bp3-file-upload-input bp3-text-overflow-ellipsis"},this.state.prompt))}}]),t}(n.Component),Pa=(a(313),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"instructions-div"},n.createElement(S.f,{className:"instructions-card"},n.createElement("h3",null,"The following columns are required for ",this.props.uploadType,":"),"models"===this.props.uploadType?n.createElement("ul",{className:"bp3-list"},n.createElement("li",null,"vendor \u2013 string"),n.createElement("li",null,"model number \u2013 string"),n.createElement("li",null,"height \u2013 positive integer; refers to the height in U of the model"),n.createElement("li",null,"display color \u2013 6-digit hex triplet (RGB) preceded by a pound sign (#); case insen- sitive; e.g. #7FFFD4, #7fffd4"),n.createElement("li",null,"network ports \u2013 non-negative integer"),n.createElement("li",null,"power ports \u2013 non-negative integer"),n.createElement("li",null,"cpu \u2013 string"),n.createElement("li",null,"memory \u2013 non-negative integer"),n.createElement("li",null,"storage \u2013 string"),n.createElement("li",null,"comment \u2013 string; must be enclosed by double quotes if value contains line breaks"),n.createElement("li",null,"network port name 1 \u2013 string; if left blank and network port exists, value defaults to \u201d1\u201d"),n.createElement("li",null,"network port name 2 \u2013 string; if left blank and network port exists, value defaults to \u201d2\u201d"),n.createElement("li",null,"network port name 3 \u2013 string; if left blank and network port exists, value defaults to \u201d3\u201d"),n.createElement("li",null,"network port name 4 \u2013 string; if left blank and network port exists, value defaults to \u201d4\u201d")):null,"assets"===this.props.uploadType?n.createElement("ul",{className:"bp3-list"},n.createElement("li",null,n.createElement("b",null,"asset number")," \u2013 six-digit integer; must be unique unless modifying an existing asset; if left blank, a value will be generated automatically; matching an existing asset number indicates that this row should modify an existing asset in the system"),n.createElement("li",null,n.createElement("b",null,"hostname")," \u2013 complies with RFC 1034 definition of \u201dlabel\u201d"),n.createElement("li",null,n.createElement("b",null,"datacenter")," \u2013 string; refers to the abbreviated form of an existing datacenter in the system (e.g. RTP1)"),n.createElement("li",null,n.createElement("b",null,"rack")," \u2013 string; the address of a rack is by a row letter (A-Z) and rack number (positive integer); there is no separator between the row letter and rack number"),n.createElement("li",null,n.createElement("b",null,"rack position")," \u2013 positive integer; refers to the vertical location (on a rack, measured in U) of the bottom of the equipment"),n.createElement("li",null,n.createElement("b",null,"vendor")," \u2013 string; refers to the vendor of the model with which this asset is associated"),n.createElement("li",null,n.createElement("b",null,"model number")," \u2013 string; refers to the model number of the model with which this asset is associated"),n.createElement("li",null,n.createElement("b",null,"owner")," \u2013 string; refers to the username of an existing user in the system who owns this equipment"),n.createElement("li",null,n.createElement("b",null,"comment")," \u2013 string; must be enclosed by double quotes if value contains line breaks"),n.createElement("li",null,n.createElement("b",null,"power port connection 1")," \u2013 reference to a PDU in the rack (L or R) and a port number (1 - 24); e.g. L5, R24; if left blank the power port will be disconnected"),n.createElement("li",null,n.createElement("b",null,"power port connection 2")," \u2013 reference to a PDU in the rack and a port number (1 - 24); e.g.L5, R24; if left blank the power port will be disconnected")):null,"network connections"===this.props.uploadType?n.createElement("ul",{className:"bp3-list"},n.createElement("li",null,n.createElement("b",null,"src hostname")," \u2013 string; matches the hostname of an existing asset in the system"),n.createElement("li",null,n.createElement("b",null,"src port")," \u2013 string; matches a network port name defined by the source asset\u2019s model"),n.createElement("li",null,n.createElement("b",null,"src mac")," \u2013 six-byte MAC address; format must comply with Requirement 2.2.1.5; sets this value for the associated src port"),n.createElement("li",null,n.createElement("b",null,"dest hostname")," \u2013 string; matches the hostname of an existing asset in the system; leaving blank will disconnect src port if it\u2019s currently connected"),n.createElement("li",null,n.createElement("b",null,"dest port")," \u2013 string; matches a network port name defined by the destination asset\u2019s model; must be given a value if a value is given for dest hostname; must be left blank if dest hostname is left blank")):null,n.createElement("h3",null,"You can find the full technical specification here:\xa0",n.createElement("a",{href:"https://d1b10bmlvqabco.cloudfront.net/attach/k4u27qnccr45oo/i515p00jifO/k6wckku7h5ne/ECE458__Bulk_Format_Proposal__v3.2.pdf"},"HypoSoft Bulk Import Specifications"))))}}]),t}(n.PureComponent)),Ta={log:function(){}},Ra=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={modifiedModels:[]},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"renderOneModification",value:function(e,t,a){var s=this;return n.createElement("div",null,n.createElement("table",{className:"bp3-html-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Modified or Original?"),Object.keys(a).map((function(e){return Ta.log(e),"id"!==e?"power_connections"===e?n.createElement("th",null):n.createElement("th",null,t[e]):n.createElement("th",null," ")})),"assets"===this.props.operation?n.createElement("th",null,"Power Port 1"):null,"assets"===this.props.operation?n.createElement("th",null,"Power Port 2"):null)),n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,"Existing"),Object.keys(a).map((function(t){if(!e.existing[t])return n.createElement("td",null," ");if("rack"===t)return n.createElement("td",null,e.existing.rack.row_letter+""+e.existing.rack.rack_num);if("model"===t)return n.createElement("td",null,e.existing.model.vendor+" "+e.existing.model.model_number);if("id"!==t){if("power_connections"!==t){if("network_ports"===t&&e.existing.network_ports){for(var a="",s=0;s<e.existing[t].length;s++)a=a+e.existing[t][s]+", ";return n.createElement("td",null,a.substring(0,a.length-2))}return n.createElement("td",null,e.existing[t])}return n.createElement("td",null)}return n.createElement("td",null," ")})),"assets"===this.props.operation?Object.keys(e.existing.power_connections).map((function(t){return n.createElement("td",null,e.existing.power_connections[t].left_right,e.existing.power_connections[t].port_number)})):null),n.createElement("tr",null,n.createElement("td",null,"Modified"),Object.keys(a).map((function(t){if("rack"===t)return n.createElement("td",null,e.modified.rack.row_letter+""+e.modified.rack.rack_num);if("model"===t)return n.createElement("td",null,e.modified.model.vendor+" "+e.modified.model.model_number);if("id"!==t){if("power_connections"!==t){if("network_ports"===t&&e.modified.network_ports){for(var a="",s=0;s<e.modified[t].length;s++)a=a+e.modified[t][s]+", ";return n.createElement("td",null,a.substring(0,a.length-2))}return n.createElement("td",null,e.modified[t])}return n.createElement("td",null)}return n.createElement("td",null," ")})),"assets"===this.props.operation?Object.keys(e.modified.power_connections).map((function(t){return n.createElement("td",null,e.modified.power_connections[t].left_right,e.modified.power_connections[t].port_number)})):null))),n.createElement("div",{className:"upload-button"},n.createElement(Ia,Object.assign({},this.props,{linkedModel:e.modified,callback:function(e){var t,a=s.state.modifiedModels.findIndex((function(t){return t.model===e}));(t=s.state.modifiedModels)[a].checked=!t[a].checked,s.setState({modifiedModels:t})}}))))}},{key:"renderModifications",value:function(e,t){for(var a=[],n=0;n<this.props.modelsModified.length;n++){var s,r=this.props.modelsModified[n];s={model:r.modified,checked:!1},this.state.modifiedModels.push(s),a.push(this.renderOneModification(r,t,e))}return a}},{key:"render",value:function(){var e,t,a=this;return void 0!==this.props.modelsModified?(e=this.props.modelsModified[0].modified,"models"===this.props.operation?t={vendor:"Vendor",model_number:"Model Number",height:"Height",display_color:"Display Color",network_ports:"Network Ports",power_ports:"Power Ports",cpu:"CPU",memory:"Memory",storage:"Storage",comment:"Comments",id:"",network_port_name_1:"Network Port #1 Name",network_port_name_2:"Network Port #2 Name",network_port_name_3:"Network Port #3 Name",network_port_name_4:"Network Port #4 Name"}:"assets"===this.props.operation?t={asset_number:"Asset Number",hostname:"Hostname",datacenter:"Datacenter",rack_position:"Rack position (U)",model:"Model",rack:"Rack",owner:"Owner",comment:"Comments",id:"",power_port_connection_1:"Power Port #1 Connection",power_port_connection_2:"Power Port #2 Connection"}:"network"===this.props.operation&&(t={src_hostname:"Source Hostname",src_port:"Source Port",src_mac:"Source MAC",dest_hostname:"Destination Hostname",dest_port:"Destination Port"}),n.createElement("div",null,this.renderModifications(e,t),n.createElement("h1",null," "),n.createElement(S.b,{className:"upload-button-import",large:!0,intent:"primary",icon:"import",text:"Confirm Changes",onClick:function(){if(0!==a.state.modifiedModels.length&&"models"===a.props.operation){var e;e=[];for(var t=0;t<a.state.modifiedModels.length;t++)a.state.modifiedModels[t].checked&&e.push(a.state.modifiedModels[t].model);ja(e,a.props.token,a.props.operation).then((function(t){var n,s;Ta.log(a.props),s=[],(n=[]).push("Success! Modified: "+e.length+"; Added: "+a.props.modelsAdded+"; Ignored: "+(a.props.modelsIgnored+a.props.modelsModified.length-e.length)),s.push(k.a.SUCCESS),t.warning_message&&(n.push(t.warning_message),s.push(k.a.WARNING)),a.setState({modifiedModels:[]}),a.props.callback(n,s)}),(function(e){a.props.callback([e.response.data.failure_message],[k.a.DANGER])}))}else if(0!==a.state.modifiedModels.length&&"assets"===a.props.operation){var n;for(n=[],t=0;t<a.state.modifiedModels.length;t++)a.state.modifiedModels[t].checked&&n.push(a.state.modifiedModels[t].model);ja(n,a.props.token,a.props.operation).then((function(e){var t,s;s=[],(t=[]).push("Success! Modified: "+n.length+"; Added: "+a.props.modelsAdded+"; Ignored: "+(a.props.modelsIgnored+a.props.modelsModified.length-n.length)),s.push(k.a.SUCCESS),e.warning_message&&(t.push(e.warning_message),s.push(k.a.WARNING)),a.setState({modifiedModels:[]}),a.props.callback(t,s)}),(function(e){a.props.callback([e.response.data.failure_message],[k.a.DANGER])}))}else{var s;for(s=[],t=0;t<a.state.modifiedModels.length;t++)a.state.modifiedModels[t].checked&&s.push(a.state.modifiedModels[t].model);ja(s,a.props.token,a.props.operation).then((function(e){var t,n;n=[],(t=[]).push("Success! Modified: "+s.length+"; Added: "+a.props.modelsAdded+"; Ignored: "+(a.props.modelsIgnored+a.props.modelsModified.length-s.length)),n.push(k.a.SUCCESS),e.warning_message&&(t.push(e.warning_message),n.push(k.a.WARNING)),a.setState({modifiedModels:[]}),a.props.callback(t,n)}),(function(e){a.props.callback([e.response.data.failure_message],[k.a.DANGER])}))}}}))):n.createElement("p",null,"No data")}}]),t}(n.PureComponent);function ja(e,t,a){var n;return fa.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(Ta.log(C+"api/"+a+"/bulk-approve"),Ta.log(t),Ta.log(e),n={headers:{Authorization:"Token "+t}},"network"!==a){s.next=8;break}return s.next=7,fa.a.awrap(y.a.post(C+"api/assets/network-bulk-approve",{approved_modifications:e},n).then((function(e){return e.data})));case 7:return s.abrupt("return",s.sent);case 8:return s.next=10,fa.a.awrap(y.a.post(C+"api/"+a+"/bulk-approve",{approved_modifications:e},n).then((function(e){return Ta.log(e.data),e.data})));case 10:return s.abrupt("return",s.sent);case 11:case"end":return s.stop()}}))}var Ia=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(Aa.a)(a)),a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("label",{className:"bp3-control bp3-checkbox"},n.createElement("input",{type:"checkbox",onChange:this.handleChange}),n.createElement("span",{className:"bp3-control-indicator"}),"Replace existing with modified?")}},{key:"handleChange",value:function(){this.props.callback(this.props.linkedModel)}}]),t}(n.PureComponent),xa=(Object(v.f)(Object(E.b)((function(e){return{token:e.token}}))(Ra)),{log:function(){}}),Fa=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={uploadFileIsOpen:!1,modelAlterationsIsOpen:!1,assetAlterationsIsOpen:!1,networkAlterationsIsOpen:!1,loadedModels:[],loadedAssets:[],uploading:!1,notify:!1,assetUploadType:"assets"},a.toaster={},a.addWarnToast=function(e){a.addToast({message:e,intent:k.a.WARNING})},a.refHandlers={toaster:function(e){return a.toaster=e}},a.handleFilepickerOpen=function(){return a.setState({uploadFileIsOpen:!0})},a.handleFilepickerCancel=function(){return a.setState({uploadFileIsOpen:!1})},a.handleFileUpload=function(){a.setState({encodedFile:void 0}),void 0!==a.state.selectedFile?(La(a.state.selectedFile).then((function(e){a.setState({encodedFile:e}),a.handleUpload(e)}),(function(e){a.addErrorToast(e.response.data.failure_message)})),a.setState({uploadFileIsOpen:!1})):a.addErrorToast("No file selected")},a.handleUpload=function(e){var t,n=(t=a.props.match.params).resourceType,s="models"===n?n:a.state.assetUploadType;xa.log(e),void 0!==e?(a.setState({uploading:!0}),Ma(e,a.props.token,s).then((function(e){xa.log(e),0!==e.modifications.length?(xa.log(e.modifications),"models"===s?a.setState({modelAlterationsIsOpen:!0,uploading:!1,modifiedModels:e.modifications,ignoredModels:e.ignored,addedModels:e.added}):"assets"===s?a.setState({assetAlterationsIsOpen:!0,uploading:!1,modifiedAssets:e.modifications,ignoredAssets:e.ignored,addedAssets:e.added}):a.setState({networkAlterationsIsOpen:!0,uploading:!1,modifiedNetwork:e.modifications,ignoredNetwork:e.ignored,addedNetwork:e.added})):(a.addSuccessToast("Success! Modified: 0; Added: "+e.added+"; Ignored: "+e.ignored),"models"===t.resourceType?a.setState({uploading:!1,loadedModels:void 0}):a.setState({uploading:!1,loadedAssets:void 0}))}),(function(e){a.setState({uploading:!1}),a.addErrorToast(e.response.data.failure_message)}))):a.addWarnToast("No data to upload"),xa.log("here, regardless of error or success"),a.setState({loadedModels:void 0,loadedAssets:void 0,modifiedModels:void 0,modifiedAssets:void 0})},a.setFile=function(e){a.setState({selectedFile:e})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addSuccessToast",value:function(e){this.addToast({message:e,intent:k.a.PRIMARY})}},{key:"addErrorToast",value:function(e){this.addToast({message:e,intent:k.a.DANGER})}},{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"createAlertToasts",value:function(e,t){for(var a=0;a<e.length;a++)t[a]===k.a.SUCCESS?this.addSuccessToast(e[a]):t[a]===k.a.WARNING?this.addWarnToast(e[a]):t[a]===k.a.DANGER&&this.addErrorToast(e[a])}},{key:"render",value:function(){var e,t=this,a=(e=this.props.match.params).resourceType;xa.log("params"),xa.log(e),xa.log(a);var s="models"===a?a:this.state.assetUploadType,r="Select "+s+" file";return n.createElement("div",{className:_.a.DARK+" import"},n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),n.createElement("div",{className:"row"},n.createElement("div",{className:"column-third-import"},"assets"===a?n.createElement(S.d,{fill:!1,style:{marginTop:40}},n.createElement(S.c,{className:"import-button",active:"assets"===this.state.assetUploadType,text:"assets",onClick:function(e){t.setState({assetUploadType:"assets"})}}),n.createElement(S.c,{className:"import-button",active:"network connections"===this.state.assetUploadType,text:"network connections",onClick:function(e){t.setState({assetUploadType:"network connections"})}})):null)),n.createElement("div",{className:"row"},n.createElement("div",{className:"column-third-import"},n.createElement("p",null," "),n.createElement(S.b,{className:"import-button",large:!0,intent:"primary",icon:"import",text:r,onClick:this.handleFilepickerOpen,style:{marginTop:20,marginBottom:40}}),n.createElement(S.u,{isOpen:this.state.uploading,className:"uploading-overlay"}," "),n.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Confirm Upload",intent:"primary",isOpen:this.state.uploadFileIsOpen,onCancel:this.handleFilepickerCancel,onConfirm:this.handleFileUpload},n.createElement("p",null,"Choose a file"),n.createElement(Da,Object.assign({},this.props,{callback:this.setFile}))),this.state.uploading?n.createElement("div",null,n.createElement("p",null,"Uploading data..."),n.createElement(S.z,{size:S.z.SIZE_STANDARD})):null)),n.createElement("div",null,n.createElement(S.i,{isOpen:this.state.modelAlterationsIsOpen,onClose:function(){return t.setState({modelAlterationsIsOpen:!1,loadedModels:void 0,modifiedModels:void 0})},className:_.a.DARK+" modify-table",usePortal:!0,isCloseButtonShown:!0,title:"Model Modifications Menu"},n.createElement(Ra,Object.assign({},this.props,{modelsModified:this.state.modifiedModels,modelsAdded:this.state.addedModels,modelsIgnored:this.state.ignoredModels,callback:function(e,a){t.setState({modelAlterationsIsOpen:!1,modifiedModels:void 0,loadedModels:void 0}),xa.log(t.state),t.createAlertToasts(e,a)},operation:"models"}))),n.createElement(S.a,{isOpen:this.state.notify,confirmButtonText:"OK",onClose:function(){return t.setState({notify:!1})}},n.createElement("p",null,"Hello"))),n.createElement("div",null,n.createElement(S.i,{isOpen:this.state.assetAlterationsIsOpen,onClose:function(){return t.setState({assetAlterationsIsOpen:!1,loadedAssets:void 0,modifiedAssets:void 0})},className:_.a.DARK+" modify-table",usePortal:!0,isCloseButtonShown:!0,title:"Asset Modifications Menu"},n.createElement(Ra,Object.assign({},this.props,{modelsModified:this.state.modifiedAssets,modelsAdded:this.state.addedAssets,modelsIgnored:this.state.ignoredAssets,callback:function(e,a){t.setState({assetAlterationsIsOpen:!1,modifiedAssets:void 0,loadedAssets:void 0}),t.createAlertToasts(e,a)},operation:"assets"})))),n.createElement("div",null,n.createElement(S.i,{isOpen:this.state.networkAlterationsIsOpen,onClose:function(){return t.setState({networkAlterationsIsOpen:!1,modifiedNetwork:void 0})},className:_.a.DARK+" modify-table",usePortal:!0,isCloseButtonShown:!0,title:"Network Connections Modifications Menu"},n.createElement(Ra,Object.assign({},this.props,{modelsModified:this.state.modifiedNetwork,modelsAdded:this.state.addedNetwork,modelsIgnored:this.state.ignoredNetwork,callback:function(e,a){t.setState({networkAlterationsIsOpen:!1,modifiedNetwork:void 0}),t.createAlertToasts(e,a)},operation:"network"})))),n.createElement(Pa,{uploadType:s}))}}]),t}(n.PureComponent);function Ma(e,t,a){var n,s,r;return fa.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n="network connections"===a?C+"api/assets/network-bulk-upload":C+"api/"+a+"/bulk-upload",xa.log(n),xa.log(t),s={headers:{Authorization:"Token "+t}},r={import_csv:e},o.next=7,fa.a.awrap(y.a.post(n,r,s).then((function(e){return xa.log(e.data),e.data})));case 7:return o.abrupt("return",o.sent);case 8:case"end":return o.stop()}}))}function La(e){return fa.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){var n=new FileReader,s="";n.onload=function(e){s=e.target.result,t(s)},n.onerror=function(e){a(e)},n.readAsDataURL(e)})));case 1:case"end":return t.stop()}}))}var Ua=Object(v.f)(Object(E.b)((function(e){return{token:e.token}}))(Fa)),Ga=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"showTabs",value:function(){return!!new RegExp("^/dashboard/(assets|models|datacenters|racks)|^/dashboard$").exec(this.props.location.pathname)}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("div",{className:_.a.DARK+" landing-view "},n.createElement(S.h,{isOpen:this.showTabs(),transitionDuration:0,keepChildrenMounted:!0},n.createElement(jt,this.props))))}}]),t}(n.Component);a(710);function Ba(e){var t={field:"user__username",filter_type:Le.TEXT,filter:{value:e,match_type:Ge.CONTAINS}},a={field:"related_asset__hostname",filter_type:Le.TEXT,filter:{value:e,match_type:Ge.CONTAINS}};return Number(e)?[t,a,{field:"related_asset__asset_number",filter_type:Le.NUMERIC,filter:{max:Number(e),min:Number(e)}}]:[t,a]}var Ha=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={logs:[],curr_page:1,total_pages:0,page_type:Ue.FIFTY,search_query:void 0,filters:void 0,is_state_loaded:!1},a.getTotalPages=function(e,t){var n,s;return fa.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={headers:{Authorization:"Token "+a.props.token},params:{page_size:e}},s=void 0!==t?{filters:t}:{},r.next=4,fa.a.awrap(y.a.post(C+"api/logs/pages",s,n).then((function(e){return e.data.page_count})));case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}))},a.getLogs=function(e,t,n){var s,r;return fa.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s={headers:{Authorization:"Token "+a.props.token},params:t===Ue.ALL?{}:{page_size:t,page:e}},r=void 0!==n?{filters:n}:{},o.next=4,fa.a.awrap(y.a.post(C+"api/logs/get-many",r,s).then((function(e){return e.data.logs})));case 4:return o.abrupt("return",o.sent);case 5:case"end":return o.stop()}}))},a.updateLogsAndPages=function(e,t,n){a.getLogs(e,t,n).then((function(e){a.setState({logs:e})})),t!==Ue.ALL&&a.getTotalPages(t,n).then((function(e){a.setState({total_pages:e})}))},a.resetPage=function(){a.setState({curr_page:1})},a.previousPage=function(){if(a.state.curr_page>1){var e=a.state.curr_page-1;a.getLogs(e,a.state.page_type).then((function(t){a.setState({logs:t,curr_page:e})}))}},a.nextPage=function(){if(a.state.curr_page<a.state.total_pages){var e=a.state.curr_page+1;a.getLogs(e,a.state.page_type).then((function(t){a.setState({logs:t,curr_page:e})}))}},a.handlePagingChange=function(e){a.resetPage(),a.setState({page_type:e}),a.updateLogsAndPages(1,e,a.state.filters)},a.handleSearch=function(){if(void 0!==a.state.search_query){var e=Ba(a.state.search_query);a.setState({filters:e}),a.resetPage(),a.updateLogsAndPages(1,a.state.page_type,e)}else a.setState({filters:void 0}),a.resetPage(),a.updateLogsAndPages(1,a.state.page_type)},a.onFormSubmit=function(e){e.preventDefault()},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"renderLinkedLog",value:function(e){if(e.related_asset){var t=e.related_asset.toString();return n.createElement("div",null,n.createElement(S.D,{content:"Click to see related asset",position:w.a.BOTTOM_RIGHT},n.createElement("a",{className:"log-link",href:i.ASSETS+"/"+t},e.log_content)))}if(e.related_model){var a=e.related_model.toString();return n.createElement("div",null,n.createElement(S.D,{content:"Click to see related model",position:w.a.BOTTOM_RIGHT},n.createElement("a",{className:"log-link",href:i.MODELS+"/"+a},e.log_content)))}return n.createElement("div",null,n.createElement(S.D,null,n.createElement("p",{className:"log-no-link"},e.log_content)))}},{key:"render",value:function(){var e=this;return this.state.is_state_loaded||(this.setState({is_state_loaded:!0}),this.updateLogsAndPages(this.state.curr_page,this.state.page_type,this.state.filters)),n.createElement("div",{className:_.a.DARK+" log-view"},n.createElement("h1",null,"Audit Logs"),n.createElement("div",{className:_.a.DARK+" bp3-input-group .modifier"},n.createElement("span",{className:"search-span bp3-icon bp3-icon-search"}),n.createElement("form",{onSubmit:this.onFormSubmit},n.createElement("span",null),n.createElement("input",{className:"search-input bp3-input .modifier",type:"text",placeholder:"Search logs by username, asset number, or asset hostname",dir:"auto",onChange:function(t){return e.setState({search_query:t.currentTarget.value})}}),n.createElement("button",{className:"search-button bp3-button bp3-minimal bp3-intent-primary bp3-icon-arrow-right .modifier",onClick:function(){return e.handleSearch()}}))),n.createElement("div",{className:"page-control"},n.createElement(S.l,{onChange:function(t){return e.handlePagingChange(t.target.value)}}," ",n.createElement("option",null," ",Ue.FIFTY),n.createElement("option",null,Ue.HUNDRED),n.createElement("option",null,Ue.ALL)),this.state.page_type!==Ue.ALL?[n.createElement("span",null,n.createElement(S.m,{className:"icon",icon:Ie.a.CARET_LEFT,iconSize:S.m.SIZE_LARGE,onClick:function(){return e.previousPage()}})),n.createElement("span",null,"page ",this.state.curr_page," of ",this.state.total_pages),n.createElement("span",null,n.createElement(S.m,{className:"icon",icon:Ie.a.CARET_RIGHT,iconSize:S.m.SIZE_LARGE,onClick:function(){return e.nextPage()}}))]:null),n.createElement("div",null,n.createElement(S.w,{className:"log-block"},this.state.logs.map((function(t){return e.renderLinkedLog(t)})))))}}]),t}(n.Component),Va=Object(E.b)((function(e){return{token:e.token}}))(Ha),Ka=a(330),za=a.n(Ka),Wa=(a(711),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={username:void 0,changePlans:[]},a.sucessfulChangePlanRequest=!1,a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getUsername",value:function(e){var t=this,a={headers:{Authorization:"Token "+e}};y.a.get(C+"api/users/who-am-i",a).then((function(e){t.setState({username:e.data.username})})).catch((function(e){}))}},{key:"clearUsernameAndLogout",value:function(){this.setState({username:void 0}),this.props.logout()}},{key:"render",value:function(){var e,t=this;return this.props.isAuthenticated&&!this.state.username&&this.getUsername(this.props.token),this.sucessfulChangePlanRequest&&!this.props.updateChangePlansBoolean||(e=this.props.token,y.a.post(C+"api/change-plans/get-many",{},B(e))).then((function(e){t.sucessfulChangePlanRequest=!0,t.props.updateChangePlans(!1);var a=e.data[l.CHANGEPLANS];a=a.filter((function(e){return Object(ht.isNullOrUndefined)(e.execution_time)})),t.setState({changePlans:a})})),n.createElement(b.a,null,n.createElement("div",null,this.props.changePlan?n.createElement("div",{onClick:function(){return t.props.history.push(i.CHANGE_PLAN+"/"+t.props.changePlan.id)}},n.createElement(za.a,{title:"Change Plan: "+this.props.changePlan.name+"\n (click here to see summary of this change plan)"})):null,n.createElement(S.q,{className:_.a.DARK+" nav-bar"},n.createElement(S.s,null,n.createElement(S.t,{onClick:function(){return t.props.history.push(i.DASHBOARD)}},n.createElement(S.b,{onClick:function(){return t.props.history.push(i.DASHBOARD)},className:"nav-bar-button",icon:"home",text:"HypoSoft",minimal:!0})),n.createElement(S.r,null),this.props.isAuthenticated?n.createElement("div",null,n.createElement(S.c,{minimal:!0,disabled:!!this.props.changePlan,text:"Report",icon:"numbered-list",onClick:function(){return t.props.history.push(i.REPORT)}}),n.createElement(S.c,{minimal:!0,onClick:function(){return t.props.history.push(i.LOGS)},icon:"history",text:"Logs",disabled:!(this.props.permissionState.admin||this.props.permissionState.audit_read)}),n.createElement(S.c,{minimal:!0,icon:"user",onClick:function(){return t.props.history.push(i.USERS)},disabled:!this.props.permissionState.admin,text:"Users"})):n.createElement("p",null)),n.createElement(S.s,{align:Qt.a.RIGHT},this.props.isAuthenticated?n.createElement("div",{className:"nav-buttons-right"},n.createElement(Pe,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},disabled:this.props.location.pathname.includes("/dashboard/change-plans/"),items:this.state.changePlans,onItemSelect:function(e){t.props.setChangePlan(e)},itemRenderer:Se,itemPredicate:de,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{minimal:!0,disabled:this.props.location.pathname.includes("/dashboard/change-plans/"),rightIcon:"caret-down",text:this.props.changePlan?this.props.changePlan.name:"Select Change Plan",icon:Ie.a.GIT_BRANCH})),this.props.changePlan?n.createElement(S.b,{minimal:!0,disabled:this.props.location.pathname.includes("/dashboard/change-plans/"),icon:Ie.a.DELETE,onClick:function(){return t.props.setChangePlan(null)}}):null,n.createElement(S.b,{onClick:function(){return t.props.history.push(i.CHANGE_PLAN)},icon:"clipboard",minimal:!0,text:"Change Plans"}),n.createElement(S.r,null),this.state.username?n.createElement(S.b,{className:"nav-bar-non-button nav-bar-button",text:"Welcome, "+this.state.username,minimal:!0}):null,n.createElement(S.b,{onClick:function(){t.clearUsernameAndLogout(),t.props.history.push(i.LOGIN)},className:"nav-bar-button",icon:"user",text:"Logout",minimal:!0})):n.createElement(S.b,{onClick:function(){return t.props.history.push(i.LOGIN)},className:"nav-bar-button",icon:"user",text:"Login",minimal:!0})))))}}]),t}(n.Component)),qa=Object(v.f)(Object(E.b)((function(e){return{isAuthenticated:null!==e.token,isAdmin:e.admin,token:e.token,changePlan:e.changePlan,updateChangePlansBoolean:e.updateChangePlansBoolean,permissionState:e.permissionState}}),(function(e){return{logout:function(){return e(X())},updateChangePlans:function(t){return e(q(t))},setChangePlan:function(t){return e(W(t))}}}))(Wa)),Ya=a(60),Ja=(a(712),{log:function(){}}),Za=function(e){function t(){var e,a;Object(p.a)(this,t);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={freeRack:0,model_allocation:[],owner_allocation:[],vendor_allocation:[],state_loaded:!1,selectedTab:"global",datacenter_loaded:!1,datacenterSelectionAlert:!1,no_data:!1},a.modelFields={vendor:"Vendor",model_number:"Model Number",allocation_percent:"Allocation %"},a.ownerFields={owner:"Owner",allocation_percent:"Allocation %"},a.vendorFields={vendor:"Vendor",allocation_percent:"Allocation %"},a.showReport=function(e){return n.createElement("div",null,a.state.state_loaded?a.state.no_data?n.createElement(S.f,{elevation:Ya.a.TWO},n.createElement("h2",{className:"report-title"},"No data available")):n.createElement(S.f,{elevation:Ya.a.TWO},n.createElement("h2",{className:"report-title"},e," Datacenter Report"),n.createElement("h4",{className:"report-summary"},"Percent of unused rack space:"," ",(100*a.state.freeRack).toFixed(2),"%"),n.createElement("h4",{className:"report-summary"},"Allocation of used rack space:"),n.createElement("div",{className:"row"},n.createElement("div",{className:"column-third-report"},n.createElement("h5",null,"Used rack space by vendor:")),n.createElement("div",{className:"column-third-right-report"},n.createElement("h5",null,"Used rack space by model:")),n.createElement("div",{className:"column-third-right-report"},n.createElement("h5",null,"Used rack space by owner:"))),n.createElement("div",{className:"row"},n.createElement("div",{className:"column-third-report"},n.createElement(Xa,{data:a.state.vendor_allocation,fields:a.vendorFields})),n.createElement("div",{className:"column-third-right-report"},n.createElement(Xa,{data:a.state.model_allocation,fields:a.modelFields})),n.createElement("div",{className:"column-third-right-report"},n.createElement(Xa,{data:a.state.owner_allocation,fields:a.ownerFields})))):n.createElement(S.z,null))},a.showDatacenterReport=function(){return n.createElement("div",null,n.createElement(S.f,{elevation:Ya.a.TWO,className:"row"},a.state.datacenters?n.createElement(S.k,{label:"",inline:!0},n.createElement(Ae,{popoverProps:{minimal:!0,popoverClassName:"dropdown",usePortal:!0},items:a.state.datacenters,onItemSelect:function(e){a.onDatacenterSelect(e)},itemRenderer:ke,itemPredicate:ue,noResults:n.createElement(S.p,{disabled:!0,text:"No results."})},n.createElement(S.c,{rightIcon:"caret-down",text:a.state.datacenter&&a.state.datacenter.name?a.state.datacenter.name:"Select datacenter"}))):null,n.createElement(S.b,{small:!0,text:"View Datacenter Report",onClick:function(){a.state.datacenter?(a.setState({datacenter_loaded:!0}),Qa(a.props.token,a.state.datacenter).then((function(e){null===e.free_rackspace_percent||void 0===e.free_rackspace_percent?a.setState({state_loaded:!0,no_data:!0}):a.setState({freeRack:e.free_rackspace_percent,model_allocation:e.model_allocation,owner_allocation:e.owner_allocation,vendor_allocation:e.vendor_allocation,state_loaded:!0})}))):a.setState({datacenterSelectionAlert:!0})}})),a.state.datacenter_loaded?a.showReport(a.state.datacenter.name):null)},a.onDatacenterSelect=function(e){a.setState({datacenter:e})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;y.a.post(C+"api/datacenters/get-many",{},B(this.props.token)).then((function(t){var a=t.data.datacenters;e.setState({datacenters:a}),$a(e.props.token).then((function(t){e.setState({freeRack:t.free_rackspace_percent,model_allocation:t.model_allocation,owner_allocation:t.owner_allocation,vendor_allocation:t.vendor_allocation,state_loaded:!0})}))}))}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:_.a.DARK+" report-all"},n.createElement(S.B,{className:"report-all",id:"ReportTabs",selectedTabId:this.state.selectedTab,animate:!0,onChange:function(t){e.setState({freeRack:0,model_allocation:[],owner_allocation:[],vendor_allocation:[],state_loaded:!1,datacenter_loaded:!1,no_data:!1}),"global"===t?$a(e.props.token).then((function(t){null===t.free_rackspace_percent||void 0===t.free_rackspace_percent?e.setState({state_loaded:!0,no_data:!0}):e.setState({freeRack:t.free_rackspace_percent,model_allocation:t.model_allocation,owner_allocation:t.owner_allocation,vendor_allocation:t.vendor_allocation,state_loaded:!0})})):e.setState({datacenter:void 0,datacenter_loaded:!1}),e.setState({selectedTab:t})}},n.createElement(S.A,{className:"report-all",id:"global",title:"Global Report",panel:this.showReport("Global")}),n.createElement(S.A,{className:"report-all",id:"datacenter",title:"Datacenter Report",panel:this.showDatacenterReport()})),n.createElement(S.a,{className:_.a.DARK,isOpen:this.state.datacenterSelectionAlert,confirmButtonText:"OK",onConfirm:function(){e.setState({datacenterSelectionAlert:!1})}},n.createElement("p",null,"Error: must select a datacenter")))}}]),t}(n.PureComponent),Xa=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("table",{className:"bp3-html-table bp3-interactive bp3-html-table-bordered bp3-html-table-striped"},n.createElement("thead",null,n.createElement("tr",null,Object.keys(this.props.data[0]).map((function(t){return Ja.log(t),n.createElement("th",null,e.props.fields[t])})))),n.createElement("tbody",null,this.props.data.map((function(e){return n.createElement("tr",null,Object.keys(e).map((function(t){return"owner"===t&&null===e[t]&&(e[t]="(No owner)"),"allocation_percent"===t?n.createElement("td",null,(100*e[t]).toFixed(2)):n.createElement("td",null,e[t])})))}))))}}]),t}(n.PureComponent);function $a(e){var t;return fa.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t={headers:{Authorization:"Token "+e}},a.next=3,fa.a.awrap(y.a.get(C+"api/report/global",t).then((function(e){return e.data})));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}))}function Qa(e,t){var a;return fa.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a={headers:{Authorization:"Token "+e}},n.next=3,fa.a.awrap(y.a.get(C+"api/report/datacenter/"+t.id,a).then((function(e){return e.data})));case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}))}var en,tn=Object(v.f)(Object(E.b)((function(e){return{token:e.token}}))(Za)),an=(a(713),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:_.a.DARK+" user-view"},n.createElement("h1",null,"Users"),n.createElement(kt,Object.assign({},this.props,{element:l.USER})))}}]),t}(n.Component)),nn=Object(E.b)((function(e){return{isAdmin:e.admin}}))(an),sn=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:_.a.DARK+" user-view"},n.createElement("h1",null,"Change Plans"),n.createElement(kt,Object.assign({},this.props,{element:l.CHANGEPLANS})))}}]),t}(n.Component),rn=Object(E.b)((function(e){return{isAdmin:e.admin}}))(sn),on=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){e||a.props.onAuth(t.username,t.password)}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement("div",null,this.props.error?n.createElement(S.e,{className:_.a.DARK,intent:k.a.DANGER},this.props.error.response.data.non_field_errors?this.props.error.response.data.non_field_errors.toString():""):null,null!==this.props.token?n.createElement(v.a,{to:"/"}):n.createElement("div",{className:_.a.DARK+" login-container"},n.createElement(Kt.a,{onSubmit:this.handleSubmit,className:"login-form .bp3-form-group"},n.createElement(Kt.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(n.createElement(S.n,{id:"username",placeholder:"username"}))),n.createElement(Kt.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(n.createElement(S.n,{type:"password",id:"password",placeholder:"password"}))),n.createElement(Kt.a.Item,null,n.createElement(S.c,{className:"login-button",type:"submit"},"Login"))),this.props.loading?n.createElement(S.z,{size:S.z.SIZE_STANDARD}):null))}}]),t}(n.Component),ln=Kt.a.create({name:"normal_login"})(on),cn=Object(E.b)((function(e){return{loading:e.loading,error:e.error,token:e.token}}),(function(e){return{onAuth:function(t,a){return e(function(e,t){return function(a){a({type:"AUTH_START"}),Y.log(C+"rest-auth/login/"),y.a.post(C+"rest-auth/login/",{username:e,password:t}).then((function(e){Y.log(e),ee(e,a)})).catch((function(e){Y.log("login failed",e),a(Z(e))}))}}(t,a))}}}))(ln),un=(a(714),a(331)),dn=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).handleSSOClick=function(){var e=window.location.href.replace(new RegExp(":","g"),"%3A").replace(new RegExp("/","g"),"%2F");window.location.href=z+e},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=un.parse(window.location.hash.substring(1)).access_token;Object(ht.isNullOrUndefined)(e)||this.props.onAuth(e.toString())}},{key:"render",value:function(){return n.createElement("div",{className:_.a.DARK+" login-container"},n.createElement("h2",null,"Login"),n.createElement(S.f,{className:"login-card",elevation:Ya.a.ZERO},n.createElement(cn,null)),n.createElement(S.f,{className:"login-card",elevation:Ya.a.ZERO},n.createElement(S.b,{onClick:this.handleSSOClick,rightIcon:"log-in"},"Duke SSO Login")))}}]),t}(n.PureComponent),pn=Object(E.b)((function(e){return{token:e.token}}),(function(e){return{onAuth:function(t){return e((a=t,function(e){e({type:"AUTH_START"}),Y.log(C+"api/users/netid-login"),y.a.post(C+"api/users/netid-login",{access_token:a}).then((function(t){Y.log(t),ee(t,e)})).catch((function(t){Y.log("login failed",t),e(Z(t))}))}));var a}}}))(Object(v.f)(dn));a(726);function mn(e,t){return y.a.get(C+"api/change-plans/"+t,B(e))}!function(e){e.MODIFY="Modify",e.CREATE="Create",e.DECOMMISSION="Decommission"}(en||(en={}));var hn=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).route_id=a.props.match.params.id,a.loading=!1,a.dataLoaded=!1,a.openPrint=!1,a.state={isOpen:[],changePlan:{},modifications:[],isAlertOpen:!1,username:"",disableButtons:!1},a.printWorkOrder=function(){a.getUsername(a.props.token);var e=a.state.isOpen.map((function(){return!0}));a.setState({isOpen:e}),a.openPrint=!0},a.toaster={},a.refHandlers={toaster:function(e){return a.toaster=e}},a.addSuccessToast=function(e){a.addToast({message:e,intent:k.a.PRIMARY})},a.addWarnToast=function(e){a.addToast({message:e,intent:k.a.WARNING})},a.addErrorToast=function(e){a.addToast({message:e,intent:k.a.DANGER})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"setButtonState",value:function(){var e=!1;!this.loading&&0!==this.state.modifications.length&&Object(ht.isNullOrUndefined)(this.state.changePlan.execution_time)||(e=!0),this.state.modifications.forEach((function(t){t.conflicts&&t.conflicts.length>0&&(e=!0)})),this.setState({disableButtons:e})}},{key:"removeModification",value:function(e){var t=this;y.a.post(C+"api/change-plans/"+this.state.changePlan.id+"/remove-asset",{asset_cp:e.asset_cp.id},B(this.props.token)).then((function(e){t.addSuccessToast(e.data.success_message),t.updateData()})).catch((function(e){t.addErrorToast(e.response.data.failure_message)}))}},{key:"updateData",value:function(){var e=this;this.loading=!0,mn(this.props.token,this.route_id).then((function(t){e.loading=!1,e.dataLoaded=!0;var a=t.data.change_plan;Object(ht.isNullOrUndefined)(a.execution_time)?e.props.setChangePlan(a):e.props.setChangePlan(null);var n=new Array(t.data.modifications.length).fill(!1);e.setState({changePlan:t.data.change_plan,modifications:t.data.modifications,isOpen:n})})).catch((function(t){e.loading=!1,e.addErrorToast(t.response.data.failure_message)}))}},{key:"resolveConflict",value:function(e,t,a){var n=this;y.a.post(C+"api/change-plans/"+this.state.changePlan.id+"/resolve-conflict",{asset_cp:e.asset_cp.id,override_live:a},B(this.props.token)).then((function(e){n.addSuccessToast(e.data.success_message),n.updateData()})).catch((function(e){n.addErrorToast(e.response.data.failure_message)}))}},{key:"handleExecuteCancel",value:function(){this.setState({isAlertOpen:!1})}},{key:"handleExecute",value:function(){var e=this;y.a.post(C+"api/change-plans/"+this.state.changePlan.id+"/execute",{},B(this.props.token)).then((function(t){e.addSuccessToast(t.data.success_message),e.setState({isAlertOpen:!1}),e.setState({disableButtons:!0}),e.updateData()})).catch((function(t){e.addErrorToast(t.response.data.failure_message),e.setState({isAlertOpen:!1})}))}},{key:"toggleCollapse",value:function(e){var t=this.state.isOpen;t[e]=!t[e],this.setState({isOpen:t})}},{key:"getHighlightStyle",value:function(e,t){var a=e.changes&&e.changes.includes(t);return{fontWeight:a?"bold":"normal",color:a?"#bf8c0a":"white"}}},{key:"addToast",value:function(e){e.timeout=5e3,this.toaster.show(e)}},{key:"renderAssetData",value:function(e,t){var a=this;return n.createElement("table",null,Object.entries(e).map((function(e){var s,r=Object(je.a)(e,2),o=r[0],l=r[1];if("network_ports"===o&&l){var c=l;s=n.createElement("td",null," ",c.toString())}else if(j(l))s=n.createElement("td",{style:a.getHighlightStyle(t,o),className:"clickable",onClick:function(e){return a.props.history.push(i.MODELS+"/"+l.id)}},l.vendor+" "+l.model_number);else{if(x(l))return[n.createElement("tr",null,n.createElement("td",{style:a.getHighlightStyle(t,o),key:o},D[o],":"),n.createElement("td",{style:a.getHighlightStyle(t,o)},l.row_letter+""+l.rack_num)),n.createElement("tr",null,n.createElement("td",{style:a.getHighlightStyle(t,o),key:"datacenter"},D.rack__datacenter__name,":"),n.createElement("td",{style:a.getHighlightStyle(t,o)},l.datacenter.name))];if("comment"===o)s=n.createElement("td",{style:a.getHighlightStyle(t,o),className:"comment"},l);else if(R(l)){if("network_connections"===o)return n.createElement("tr",null,n.createElement("td",{style:a.getHighlightStyle(t,o),key:o},"Network Connections"),n.createElement("td",{style:a.getHighlightStyle(t,o)},n.createElement("pre",null,JSON.stringify(l,null,2))));if("power_connections"===o)return n.createElement("tr",null,n.createElement("td",{style:a.getHighlightStyle(t,o),key:o},"Power Connections"),n.createElement("td",{style:a.getHighlightStyle(t,o)},n.createElement("pre",null,JSON.stringify(l,null,2))))}else s=n.createElement("td",{style:a.getHighlightStyle(t,o)},l)}return D[o]?n.createElement("tr",null,n.createElement("td",{style:a.getHighlightStyle(t,o),key:o},D[o],":"),s):null})))}},{key:"componentDidMount",value:function(){var e=this;!this.dataLoaded&&this.route_id&&(this.loading=!0,mn(this.props.token,this.route_id).then((function(t){e.loading=!1,e.dataLoaded=!0;var a=t.data.change_plan;Object(ht.isNullOrUndefined)(a.execution_time)?e.props.setChangePlan(a):e.props.setChangePlan(null),e.setButtonState();var n=new Array(t.data.modifications.length).fill(!1);e.setState({changePlan:t.data.change_plan,modifications:t.data.modifications,isOpen:n})})).catch((function(t){e.loading=!1,e.addErrorToast(t.response.data.failure_message)})))}},{key:"getUsername",value:function(e){var t=this,a={headers:{Authorization:"Token "+e}};y.a.get(C+"api/users/who-am-i",a).then((function(e){t.setState({username:e.data.username})})).catch((function(e){}))}},{key:"render",value:function(){var e=this;return this.openPrint&&this.state.isOpen.every((function(e){return!0===e}))&&(this.openPrint=!1,setTimeout((function(){window.print()}),1e3)),!this.dataLoaded&&this.route_id&&(this.loading=!0,mn(this.props.token,this.route_id).then((function(t){e.loading=!1,e.dataLoaded=!0;var a=t.data.change_plan;Object(ht.isNullOrUndefined)(a.execution_time)?e.props.setChangePlan(a):e.props.setChangePlan(null),e.setButtonState();var n=new Array(t.data.modifications.length).fill(!1);e.setState({changePlan:t.data.change_plan,modifications:t.data.modifications,isOpen:n})})).catch((function(t){e.loading=!1,e.addErrorToast(t.response.data.failure_message)}))),n.createElement("div",{className:_.a.DARK+" asset-view"},n.createElement(S.a,{cancelButtonText:"Cancel",confirmButtonText:"Execute",intent:k.a.WARNING,className:_.a.DARK,isOpen:this.state.isAlertOpen,onCancel:function(){return e.handleExecuteCancel()},onConfirm:function(){return e.handleExecute()}},n.createElement("p",null,"Are you sure you want to execute this change plan? You will not be able to generate a work order for this change plan anymore.")),n.createElement(S.C,{autoFocus:!1,canEscapeKeyClear:!0,position:w.a.TOP,ref:this.refHandlers.toaster}),n.createElement("h1",{className:_.a.DARK},"Change Plan:"," ",this.state.changePlan?this.state.changePlan.name:null),this.loading?n.createElement(S.z,null):null,n.createElement("ul",{className:"bp3-list-unstyled"},n.createElement(S.e,{className:"print",intent:"primary"},"This work order was generated by user ",this.state.username," on"," ",(new Date).toString()),this.state.changePlan&&this.state.changePlan.execution_time?n.createElement(S.e,{intent:"primary"},"This change plan was executed at:"," ",this.state.changePlan.execution_time):null,this.state.modifications.length>0?this.state.modifications.map((function(t,a){return n.createElement("li",null,n.createElement(S.e,{icon:null,intent:t.conflicts&&t.conflicts.length>0?k.a.DANGER:k.a.NONE,className:"change-plan-item",onClick:function(t){return e.toggleCollapse(a)}},n.createElement(S.g,{className:"print"}),t.title,n.createElement(S.b,{className:"cp-remove",intent:k.a.DANGER,minimal:!0,disabled:!Object(ht.isNullOrUndefined)(e.state.changePlan)&&!Object(ht.isNullOrUndefined)(e.state.changePlan.execution_time),icon:"delete",onClick:function(a){e.removeModification(t),a.stopPropagation()},text:"Discard change"})),n.createElement(S.h,{isOpen:e.state.isOpen[a]},n.createElement("div",{className:"cp-collapse-body"},t.conflicts?t.conflicts.map((function(a){return n.createElement(S.e,{intent:k.a.DANGER},a.conflict_message,a.conflict_resolvable?n.createElement("div",{className:"merge-options"},n.createElement(S.b,{onClick:function(){return e.resolveConflict(t,a,!1)},icon:"properties",text:"Discard change plan modifications"}),n.createElement(S.b,{onClick:function(){return e.resolveConflict(t,a,!0)},icon:"properties",text:"Keep change plan modifications"})):null)})):null,n.createElement(S.b,{className:"asset-detail",icon:"properties",onClick:function(a){e.props.history.push(i.ASSETS+"/"+t.asset_cp.id)},text:"Go to change plan asset detail page"}),t.asset&&Object(ht.isNullOrUndefined)(e.state.changePlan.execution_time)?n.createElement("div",{className:"cp-details"},n.createElement(S.w,null,n.createElement("h3",null,"Live Asset "),e.renderAssetData(t.asset,t)),n.createElement(S.w,null,n.createElement("h3",null,"Change Plan Asset"),t.asset_cp?e.renderAssetData(t.asset_cp,t):null)):n.createElement("div",{className:"cp-details"},n.createElement(S.w,null,n.createElement("h3",null,"Change Plan Asset"),t.asset_cp?e.renderAssetData(t.asset_cp,t):null)))))})):n.createElement(S.e,{title:"No modifications for this change plan"}," ")),n.createElement("div",{className:"detail-buttons-wrapper"},n.createElement("div",{className:"detail-buttons-cp"},n.createElement("div",null,n.createElement(S.b,{onClick:function(){return e.printWorkOrder()},disabled:this.state.disableButtons,intent:"none",icon:"document-open",text:"Generate Work Order"})),n.createElement("div",{className:"cp-dividers"},n.createElement(S.j,{className:"cp-detail-divider"}),n.createElement("p",{className:_.a.DARK+" cp-detail-divider-text"},"then"),n.createElement(S.j,{className:"cp-detail-divider"})),n.createElement("div",null,n.createElement(S.b,{disabled:this.state.disableButtons,icon:"build",intent:"primary",text:"Execute Change Plan",onClick:function(){return e.setState({isAlertOpen:!0})}})))))}}]),t}(n.Component),fn=Object(v.f)(Object(E.b)((function(e){return{token:e.token}}),(function(e){return{logout:function(){return e(X())},updateChangePlans:function(t){return e(q(t))},setChangePlan:function(t){return e(W(t))}}}))(hn)),gn={log:function(){}},En=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).RedirectToLoginRoute=function(e){var t=Object(d.a)({},e);return a.props.isAuthenticated?s.a.createElement(v.b,t):s.a.createElement(v.b,t,s.a.createElement(v.a,{to:i.LOGIN}))},a.PrivateRoute=function(e){var t=e.path,n=e.component,r=e.render,o=Object(u.a)(e,["path","component","render"]);return n?s.a.createElement(v.b,Object.assign({path:t},o,{component:a.props.isAuthenticated?n:ya})):r?s.a.createElement(v.b,Object.assign({path:t},o,{render:a.props.isAuthenticated?r:ya})):null},a.AdminRoute=function(e){var t=e.path,n=e.component,r=Object(u.a)(e,["path","component"]);return s.a.createElement(v.b,Object.assign({path:t,component:a.props.isAuthenticated?a.props.permissionState.admin?n:Na:ya},r))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){gn.log(this.props.isAuthenticated),this.props.onTryAutoSignup()}},{key:"detectMob",value:function(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(e){return navigator.userAgent.match(e)}))}},{key:"render",value:function(){return s.a.createElement(b.a,{basename:"/"},s.a.createElement("div",null,s.a.createElement(qa,this.props),s.a.createElement(v.b,{path:i.LOGIN,component:pn}),s.a.createElement("div",{className:"dashboard "},s.a.createElement(this.PrivateRoute,{path:i.DASHBOARD,render:function(e){return s.a.createElement(Ga,e)}}),s.a.createElement(this.RedirectToLoginRoute,{exact:!0,path:"/"}," ",s.a.createElement(v.a,{to:i.DASHBOARD})),s.a.createElement(v.b,{path:"/",component:Ca}),s.a.createElement(this.PrivateRoute,{path:i.MODELS+"/:rid",component:va}),s.a.createElement(this.PrivateRoute,{path:i.ASSETS+"/:rid",component:ma}),s.a.createElement(this.PrivateRoute,{path:i.CHANGE_PLAN+"/:id",component:fn})),s.a.createElement(this.PrivateRoute,{path:i.REPORT,component:tn}),s.a.createElement(this.PrivateRoute,{path:i.LOGS,component:Va}),s.a.createElement(this.PrivateRoute,{path:i.RACK_PRINT,component:wt}),s.a.createElement(this.PrivateRoute,{path:i.BARCODE_PRINT,component:Sa}),s.a.createElement(this.PrivateRoute,{exact:!0,path:i.CHANGE_PLAN,component:rn}),s.a.createElement(this.PrivateRoute,{path:i.BULK_IMPORT,component:Ua}),s.a.createElement(this.AdminRoute,{path:i.USERS,component:nn})))}}]),t}(s.a.Component),vn=Object(E.b)((function(e){return{isAuthenticated:null!==e.token,isAdmin:e.admin,permissionState:e.permissionState,loading:e.loading}}),(function(e){return{onTryAutoSignup:function(){e((function(e){var t=localStorage.getItem("token");void 0===t?e(X()):new Date(localStorage.getItem("expirationDate"))<=new Date?e(X()):(e(J(t)),e($(t)),e(Q(t)))}))}}}))(En),bn=a(39),kn={token:null,error:null,loading:!1,changePlan:null,permissionState:{model_management:!1,asset_management:!1,power_control:!1,audit_read:!1,admin:!1,datacenter_permissions:[]}},_n=function(e,t){return Re(e,{changePlan:t.changePlan})},Sn=function(e,t){return Re(e,{updateChangePlansBoolean:t.updateChangePlansBoolean})},wn=function(e,t){return Re(e,{permissionState:t.permissionState})},On=function(e,t){return Re(e,{error:null,loading:!0})},yn=function(e,t){return Re(e,{token:t.token,error:null,loading:!1})},Nn=function(e,t){return Re(e,{error:t.error,loading:!1})},Cn=function(e,t){return Re(e,{token:null,admin:null})},An=function(e,t){return Re(e,{admin:!0})},Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return On(e);case"AUTH_SUCCESS":return yn(e,t);case"AUTH_FAIL":return Nn(e,t);case"AUTH_LOGOUT":return Cn(e);case"AUTH_ADMIN":return An(e);case"SWITCH CHANGE PLAN":return _n(e,t);case"UPDATE CHANGE PLANS":return Sn(e,t);case"SET PERMISSION STATE":return wn(e,t);default:return e}},Pn=a(332),Tn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||bn.c||bn.c,Rn=Object(bn.d)(Dn,Tn(Object(bn.a)(Pn.a))),jn=s.a.createElement(E.a,{store:Rn},s.a.createElement(vn,null));o.a.render(jn,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},74:function(e,t,a){}},[[366,1,2]]]);
//# sourceMappingURL=main.d307eab8.chunk.js.map